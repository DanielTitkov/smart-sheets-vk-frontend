{"version":3,"sources":["store/actions/panelActions.js","components/interface/ErrorSnackbar.js","components/user/UserSnippet.js","config/appConfig.js","utils/arrayUtils.js","store/actions/sheetsActions.js","components/sheets/TextFrame.js","components/sheets/SheetTitle.js","styles/inline.js","components/sheets/SheetHeader.js","utils/sheetsBuilder.js","components/interface/ConfirmationPopout.js","components/sheets/SheetSnippet.js","store/actions/popoutActions.js","components/sheets/SheetList.js","components/sheets/ActiveSheetSnippet.js","panels/Home.js","store/actions/userActions.js","utils/dateUtils.js","components/sheets/NewSheetSnippet.js","components/sheets/NewSheetList.js","panels/sheets/Catalog.js","components/user/UserSettings.js","panels/profile/Settings.js","components/sheets/SheetGuideBlock.js","components/sheets/SheetGuide.js","panels/sheets/Editor.js","components/sheets/SheetDetails.js","panels/sheets/Details.js","panels/about/About.js","components/sheets/rubrics/RubricSnippet.js","components/sheets/rubrics/RubricsList.js","panels/sheets/rubrics/Rubrics.js","App.js","store/actions/validationActions.js","store/reducers/panelReducer.js","store/reducers/validationReducer.js","store/reducers/userReducer.js","store/reducers/modalReducer.js","store/reducers/sheetsReducer.js","store/reducers/popoutReducer.js","store/reducers/rootReducer.js","Provider.js","index.js"],"names":["setActivePanel","panel","dispatch","getState","type","ErrorSnackbar","props","onClose","error","layout","toString","UserSnippet","useDispatch","currentUser","profile","before","photo_200","src","size","description","city","title","asideContent","style","display","className","mode","onClick","first_name","last_name","appConfig","API_URL","DEFAULT_DATA_FIELD","EDITOR_SAVE_INTERVAL","urls","PROFILE","SETTINGS","RUBRICS","dataArrayToObject","dataArray","data","forEach","d","elementId","content","dataObjectToArray","dataObject","Object","entries","map","setActiveSheet","sheetOrBlueprint","activeSheet","sheets","newSheet","blueprint","id","sheet","setActiveRubric","rubric","getRecentSheets","url","vkquery","validation","params","query","axios","get","then","response","catch","err","postActiveSheet","put","blueprintId","post","getSheetRubrics","parent","rubrics","TextFrame","dataField","updateFunction","useState","value","setValue","useEffect","imageURL","alt","desc","onChange","e","target","SheetTitle","inputRef","useRef","inputVisible","setInputVisible","onClickOutSide","current","contains","document","addEventListener","removeEventListener","autoFocus","ref","placeholder","avatarStyle","maxHeight","maxWidth","objectFit","objectPosition","backgroundImage","image","SheetHeader","getElementData","getSheetTitle","titleField","elementData","titleElementId","ConfirmationPopout","action","message","actionsLayout","actions","autoclose","SheetSnippet","sheetTitle","confirmDeletePopout","deleted","deleteSheet","updated","moment","format","imageUrl","popout","SheetList","loading","key","ActiveSheetSnippet","useSelector","state","header","multiline","bottomContent","Home","user","recentSheetsLoading","recentSheets","sheetsError","snackbar","setSnackbar","errorSnackbar","sendCurrentUserData","age","bdate","date","diff","getAgeFromBDate","userData","undefined","sex","timezone","country","getCurrentUserSettings","console","log","settings","NewSheetSnippet","NewSheetList","blueprints","length","osname","platform","Catalog","sheetBlueprints","activeRubric","getSheetBlueprints","left","IOS","UserSettings","encrypt","setEncrypt","checked","top","bottom","defaultValue","Settings","stretched","SheetGuideBlock","text","onButtonClick","wide","reactHtmlParser","SheetGuide","guide","example","guideOpen","setGuideOpen","exampleOpen","setExampleOpen","Editor","sheetBody","structure","elementMapping","React","createElement","field","buildSheetStructure","dataContent","updateActiveSheetData","interval","setInterval","clearInterval","SheetDetails","Fragment","Details","About","rel","href","RubricSnippet","disabled","caption","after","hasChildren","RubricsList","Rubrics","activePanel","App","modal","parseQueryString","string","slice","split","queryParam","kvp","reduce","queryParams","window","location","search","hashParams","hash","vk_access_token_settings","decodeURIComponent","vkconnect","sendPromise","marginTop","initState","panelReducer","validationReducer","userReducer","modalReducer","parentRubric","sheetsReducer","popoutReducer","rootReducer","combineReducers","ProviderWrapper","children","store","send","createStore","applyMiddleware","thunk","SmartSheetsApp","Provider","ReactDOM","render","getElementById"],"mappings":"o0BAAaA,EAAiB,SAACC,GAC3B,OAAO,SAACC,EAAUC,GACdD,EAAS,CAAEE,KAAM,mBAAoBH,MAAOA,M,OCCrC,SAASI,EAAcC,GAAQ,IAClCC,EAAmBD,EAAnBC,QAASC,EAAUF,EAAVE,MACjB,OACI,kBAAC,IAAD,CACQC,OAAO,WACPF,QAAUA,GAEV,2BAAKC,EAAQA,EAAME,WAAa,qB,WC+BjCC,EAlCK,SAAAL,GACnB,IAAMJ,EAAWU,cACNC,EAAgBP,EAAhBO,YACR,OAAQA,GAAeA,EAAYC,SACrC,kBAAC,IAAD,KACC,kBAAC,IAAD,CACCC,OAASF,EAAYC,QAAQE,UAAY,kBAAC,IAAD,CAAQC,IAAMJ,EAAYC,QAAQE,YAAgB,KAC3FE,KAAK,IACLC,YAAcN,EAAYC,QAAQM,MAAQP,EAAYC,QAAQM,KAAKC,MAAQR,EAAYC,QAAQM,KAAKC,MAAQ,GAC5GC,aACC,yBAAKC,MAAQ,CAAEC,QAAS,SACvB,kBAAC,IAAD,CACCC,UAAU,qBACVC,KAAK,WACLC,QAAU,kBAAMzB,EAASF,EAAe,YAHzC,uEAOA,kBAAC,IAAD,CACCyB,UAAU,qBACVC,KAAK,WACLC,QAAU,kBAAMzB,EAASF,EAAe,sBAHzC,gDAbH,UAuBKa,EAAYC,QAAQc,WAvBzB,YAuBuCf,EAAYC,QAAQe,c,oECxB/CC,EAXG,CACdC,QAAS,qDACTC,mBAAoB,UACpBC,qBAAsB,IACtBC,KAAM,CACFC,QAAS,mBACTC,SAAU,oBACVC,QAAS,a,iBCPJC,EAAoB,SAACC,GAC9B,IAAIC,EAAO,GAIX,OAHAD,GAAaA,EAAUE,SAAQ,SAAAC,GAC3BF,EAAKE,EAAEC,WAAaD,EAAEE,WAEnBJ,GAGEK,EAAoB,SAACC,GAC9B,OAAOC,OAAOC,QAAQF,GAAYG,KAAI,YAAmB,IAAD,mBACpD,MAAO,CACHN,UAFgD,KAGhDC,QAHgD,UCL/CM,EAAiB,SAACC,GAC3B,OAAO,SAACjD,EAAUC,GAAc,IACpBiD,EAAgBjD,IAAWkD,OAA3BD,YACJE,EAAW,KACXH,GAAoBA,EAAiBI,UACrCD,EAAWF,GAAeA,EAAYI,IAAOJ,EAAYI,KAAOL,EAAiBK,GAAMJ,EAAcD,GAErGG,EAAW,IACH,UAAgBH,EAG5BjD,EAAS,CACLE,KAAM,mBACNqD,MAAOH,MAKNI,EAAkB,SAACC,GAC5B,OAAO,SAACzD,EAAUC,GAGdD,EAAS,CACLE,KAAM,oBACNuD,OAAQA,MAWPC,EAAkB,WAC3B,OAAO,SAAC1D,EAAUC,GAEdD,EAAS,CAACE,KAAM,gBAEhB,IAAMyD,EAAM/B,EAAUC,QACd+B,EAAY3D,IAAW4D,WAAvBD,QACFE,EAAM,eAAOF,EAAQG,OAE3BC,IAAMC,IAAIN,EAAM,UAAW,CACvBG,OAAQA,IAEXI,MAAK,SAAAC,GACFnE,EAAS,CACLE,KAAM,4BACNiD,OAAQgB,EAAS7B,UAGxB8B,OAAM,SAAAC,GACHrE,EAAS,CACLE,KAAM,yBACNI,MAAO+D,SA8BVC,EAAkB,WAC3B,OAAO,SAACtE,EAAUC,GACd,IAAM0D,EAAM/B,EAAUC,QACdqB,EAAgBjD,IAAWkD,OAA3BD,YACAU,EAAY3D,IAAW4D,WAAvBD,QAEJV,GAAeA,EAAYI,GAC3BU,IAAMO,IACFZ,EAAM,UAAYT,EAAYI,GAAK,IACnC,CACIkB,YAAatB,EAAYG,UAAUC,GACnChB,KAAMK,EAAkBO,EAAYZ,OAExC,CACIwB,OAAO,eAAMF,EAAQG,SAE3BG,MAAK,SAAAC,GACHnE,EAAS,CAAEE,KAAM,4BAA6BqD,MAAOY,EAAS7B,OAC9DtC,EAAS0D,QACVU,OAAM,SAAAC,GACLrE,EAAS,CAAEE,KAAM,0BAA2BI,MAAO+D,OAEhDnB,GACPc,IAAMS,KACFd,EAAM,UACN,CACIa,YAAatB,EAAYG,UAAUC,GACnChB,KAAMK,EAAkBO,EAAYZ,OAExC,CACIwB,OAAO,eAAMF,EAAQG,SAE3BG,MAAK,SAAAC,GACHnE,EAAS,CAAEE,KAAM,4BAA6BqD,MAAOY,EAAS7B,OAC9DtC,EAAS0D,QACVU,OAAM,SAAAC,GACLrE,EAAS,CAAEE,KAAM,0BAA2BI,MAAO+D,SA8BtDK,EAAkB,WAAkB,IAAjBC,EAAgB,uDAAT,KACnC,OAAO,SAAC3E,EAAUC,GACdD,EAAS,CAACE,KAAM,gBAEhB,IAAMyD,EAAM/B,EAAUC,QACd+B,EAAY3D,IAAW4D,WAAvBD,QACFE,EAASa,EAAM,eAAOf,EAAQG,MAAf,CAAsBY,OAAQA,EAAOrB,KAArC,eAA+CM,EAAQG,OAE5EC,IAAMC,IAAIN,EAAM/B,EAAUI,KAAKG,QAAS,CACpC2B,OAAQA,IAEXI,MAAK,SAAAC,GACFnE,EAAS,CACLE,KAAM,4BACN0E,QAAST,EAAS7B,UAGzB8B,OAAM,SAAAC,GACHrE,EAAS,CACLE,KAAM,0BACNI,MAAO+D,SCxIRQ,G,OAnCG,SAAAzE,GACd,IAAM0E,EAAYlD,EAAUE,mBACpBgC,EAAiC1D,EAAjC0D,OAAQxB,EAAyBlC,EAAzBkC,KAAMyC,EAAmB3E,EAAnB2E,eAFC,EAGKC,mBAAS1C,EAAOA,EAAKwC,GAAa,IAHvC,mBAGfG,EAHe,KAGRC,EAHQ,KAUvB,OALAC,qBAAU,WACNJ,EAAeE,EAAOH,KAEvB,CAACG,EAAOH,IAGP,yBAAKvD,UAAU,aACX,kBAAC,IAAD,KACI,yBAAKA,UAAU,oBACTuC,EAAOsB,UACL,yBAAK7D,UAAU,0BACX,yBAAKR,IAAM+C,EAAOsB,SAAWC,IAAI,MAGzC,yBAAK9D,UAAU,yBACTuC,EAAO3C,MAAS,4BAAM2C,EAAO3C,OAAgB,KAC7C2C,EAAOwB,KAAQ,4BAAMxB,EAAOwB,MAAe,OAGrD,yBAAK/D,UAAU,2BACX,kBAAC,IAAD,CACI0D,MAAQA,EACRM,SAAW,SAAAC,GAAC,OAAIN,EAASM,EAAEC,OAAOR,eCkB3CS,G,OA9CI,SAAAtF,GACf,IAAM0E,EAAYlD,EAAUE,mBACpBgC,EAAiC1D,EAAjC0D,OAAQxB,EAAyBlC,EAAzBkC,KAAMyC,EAAmB3E,EAAnB2E,eAChBY,EAAWC,iBAAO,MAHA,EAIgBZ,oBAAS,GAJzB,mBAIjBa,EAJiB,KAIHC,EAJG,OAKEd,mBAAS1C,EAAOA,EAAKwC,GAAahB,EAAO3C,OAL3C,mBAKjB8D,EALiB,KAKVC,EALU,KAMlBa,EAAiB,SAACP,GAChBG,EAASK,UAAYL,EAASK,QAAQC,SAAST,EAAEC,SACjDK,GAAgB,IAqBxB,OAdAX,qBAAU,WAIN,OAHIU,GACAK,SAASC,iBAAiB,YAAaJ,GAEpC,WACHG,SAASE,oBAAoB,YAAaL,OAIlDZ,qBAAU,WACNJ,EAAeE,EAAOH,KAEvB,CAACG,EAAOH,IAGP,yBAAKvD,UAAU,cACVsE,EACG,2BACIQ,WAAS,EACTC,IAAMX,EACNV,MAAQA,EACRM,SAAW,SAAAC,GAAC,OAAIN,EAASM,EAAEC,OAAOR,QAClCsB,YAAY,iJAGhB,wBAAI9E,QA7BM,SAAA+D,GAClBM,GAAgB,KA4BwBb,GAAgBnB,EAAO3C,UC5C1DqF,EAAc,CACvBC,UAAW,OACXC,SAAU,OACVC,UAAW,QACXC,eAAgB,UAGPC,EAAkB,SAAAC,GAC3B,MAAO,CACHD,gBAAgB,OAAD,OAASC,EAAT,OCGRC,G,OAPK,SAAA3G,GAAU,IAClB0D,EAAW1D,EAAX0D,OACR,OAAOA,EAAOsB,SACV,yBAAK7D,UAAU,yBAAyBF,MAAQwF,EAAgB/C,EAAOsB,YACvE,OCoBF4B,EAAiB,SAACpE,EAAYH,GAChC,OAAOG,EAAWH,IAGhBwE,EAAgB,SAAC1D,GAAoD,IAA7C2D,EAA4C,uDAAjCtF,EAAUE,mBACzCqF,EAAcH,EAAezD,EAAMjB,KAAMiB,EAAMF,UAAU+D,gBAC/D,OAAOD,EAAcA,EAAYD,GAAc,MCTpCG,EAvBY,SAAAjH,GAAU,IACzBC,EAAoCD,EAApCC,QAASiH,EAA2BlH,EAA3BkH,OAAQnG,EAAmBf,EAAnBe,MAAOoG,EAAYnH,EAAZmH,QAChC,OACI,kBAAC,IAAD,CACIC,cAAc,WACdC,QAAS,CAAC,CACNtG,MAAOA,EACPuG,WAAW,EACXlG,KAAM,cACN8F,OAAQA,GACT,CACCnG,MAAO,uCACPuG,WAAW,EACXlG,KAAM,WAEVnB,QAAU,kBAAMA,MAEhB,mJACA,2BAAKkH,KC4CFI,G,OAlDM,SAAAvH,GACjB,IAAMJ,EAAWU,cACT6C,EAAUnD,EAAVmD,MACFqE,EAAaX,EAAc1D,GAC3BsE,EAAsB,kBAAC,EAAD,CACxBxH,QAAU,kBAAML,GCbb,SAACA,EAAUC,GACdD,EAAS,CAAEE,KAAM,qBDajBoH,OAAS,kBAAMtH,EP+GI,SAACuD,GACxB,OAAO,SAACvD,EAAUC,GACd,IAAM0D,EAAM/B,EAAUC,QACd+B,EAAY3D,IAAW4D,WAAvBD,QACRI,IAAMO,IAEFZ,EAAM,UAAYJ,EAAMD,GAAK,IAC7B,CACIkB,YAAajB,EAAMF,UAAUC,GAC7BhB,KAAMK,EAAkBY,EAAMjB,MAC9BwF,SAAS,GAEb,CACIhE,OAAO,eAAMF,EAAQG,SAE3BG,MAAK,SAAAC,GACHnE,EAAS,CAAEE,KAAM,uBAAwBoD,GAAIC,EAAMD,KACnDtD,EAAS0D,QACVU,OAAM,SAAAC,GACLrE,EAAS,CAAEE,KAAM,qBAAsBI,MAAO+D,QOlI1B0D,CAAYxE,KACpCpC,MAAM,oGACNoG,QAAQ,0HAENS,EAAUC,IAAO1E,EAAMyE,SAASE,OAAO,oBAE7C,OACI,yBAAK3G,UAAU,gBACX,kBAAC,IAAD,CACIV,OACI0C,EAAMF,UAAU8E,UAAY,kBAAC,IAAD,CACxB5G,UAAU,sBACVrB,KAAK,QACLa,IAAMwC,EAAMF,UAAU8E,SACtB9G,MAAQmF,IAGhBvF,YAAcsC,EAAMF,UAAUnD,KAAO,MAAQ8H,EAC7C5G,aACI,yBAAKG,UAAU,yBACX,kBAAC,IAAD,CACIV,OAAQ,kBAAC,IAAD,MACRY,QAAU,WACNzB,EAASgD,EAAeO,IACxBvD,EAASF,EAAe,aAJhC,QASA,kBAAC,IAAD,CACIe,OAAQ,kBAAC,IAAD,MACRY,QAAW,kBAAMzB,GCpDlBoI,EDoDsCP,ECnDtD,SAAC7H,EAAUC,GACdD,EAAS,CAAEE,KAAM,cAAekI,OAAQA,OAFtB,IAACA,IDkDH,YASNR,ME5BHS,G,OAzBG,SAAAjI,GAAU,IAChB+C,EAAoB/C,EAApB+C,OAAQmF,EAAYlI,EAAZkI,QAChB,OACI,kBAAC,IAAD,KACMA,EACE,kBAAC,IAAD,CAAStH,KAAK,QAAQO,UAAU,sBAEhC,KAGF4B,EAASA,EAAOJ,KAAI,SAAAQ,GAClB,OACI,kBAAC,EAAD,CACIgF,IAAMhF,EAAMD,GACZC,MAAQA,OAKhB,kBAAC,IAAD,yBCgBDiF,EAlCY,SAAApI,GACvB,IAAMJ,EAAWU,cACXwC,EAAcuF,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAOD,eACtD,OACIA,EACI,kBAAC,IAAD,CAAOyF,OAAQ,kBAAC,IAAD,CAAQnH,KAAK,aAAb,sGACX,kBAAC,IAAD,CACIX,OACI,kBAAC,IAAD,CACIG,KAAM,GACND,IAAKmC,EAAYG,UAAU8E,SAC3B9G,MAAQmF,IAGhBoC,WAAS,EACT5H,KAAK,IACLC,YACIiC,EAAYG,UAAUnD,KAE1B2I,cACI,6BACI,kBAAC,IAAD,CAAQpH,QAAU,kBAAMzB,EAASF,EAAe,aAAhD,kEAINmH,EAAc/D,KAIxB,MC+BG4F,EAxDF,SAAC1I,GAAW,IAChBkD,EAAOlD,EAAPkD,GAEFtD,EAAWU,cACXC,EAAc8H,aAAY,SAAAC,GAAK,OAAIA,EAAMK,KAAKpI,eAC9CqI,EAAsBP,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAOmF,WACxDW,EAAeR,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAO8F,gBACjDC,EAAcT,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAO7C,SAP/B,EAQS0E,mBAAS,MARlB,mBAQhBmE,EARgB,KAQNC,EARM,KAqBvB,OAXAjE,qBAAU,WACT,IAAMkE,EAAgB,kBAAClJ,EAAD,CAAeE,QAAS,kBAAM+I,EAAY,OAAO9I,MAAO4I,IAC1EA,GACHE,EAAYC,KAEX,CAACH,IAEJ/D,qBAAU,WACTnF,EAAS0D,OACP,CAAC1D,IAGH,kBAAC,IAAD,CAAOsD,GAAIA,GACV,kBAAC,IAAD,wFACA,kBAAC,EAAD,CAAa3C,YAAcA,IAC3B,kBAAC,EAAD,MACS,kBAAC,IAAD,KACR,kBAAC,IAAD,KACC,kBAAC,IAAD,CACCK,KAAK,KACLQ,KAAK,YACLC,QAAU,kBAAMzB,EAASF,EAAe,cAEtC,wBAGJ,kBAAC,EAAD,CAAWqD,OAAS8F,EAAeX,QAAUU,KAE9C,kBAAC,IAAD,4BACEG,IChCQG,EAAsB,WAC/B,OAAO,SAACtJ,EAAUC,GAAc,IACpBW,EAAYX,IAAW8I,KAAKpI,YAA5BC,QACF2I,ECnBiB,SAAAC,GAC7B,IAAIC,EAAOxB,IAAOuB,EAAO,cACzB,OAAOvB,MAASyB,KAAKD,EAAM,SAAS,GDiBlBE,CAAgB/I,EAAQ4I,OAC9BI,EAAW,CACbL,IAAKA,QAAYM,EACjBC,IAAKlJ,EAAQkJ,IAAMlJ,EAAQkJ,SAAMD,EACjC3I,KAAMN,EAAQM,KAAON,EAAQM,KAAKC,WAAQ0I,EAC1CE,SAAUnJ,EAAQmJ,SAAWnJ,EAAQmJ,cAAWF,EAChDG,QAASpJ,EAAQoJ,QAAUpJ,EAAQoJ,QAAQ7I,WAAQ0I,GAE/CjG,EAAY3D,IAAW4D,WAAvBD,QACFD,EAAM/B,EAAUC,QACtBmC,IAAMS,KACFd,EAAM/B,EAAUI,KAAKC,QACrB2H,EACA,CACI9F,OAAO,eACAF,EAAQG,SAItBG,MAAK,SAAAC,GACFnE,EAAS,CAAEE,KAAM,2BACjBF,EAASiK,QAEZ7F,OAAM,SAAAC,GACHrE,EAAS,CACLE,KAAM,uBACNI,MAAO+D,SAMjB4F,EAAyB,WAC3B,OAAO,SAACjK,EAAUC,GAAc,IACpB2D,EAAY3D,IAAW4D,WAAvBD,QACFD,EAAM/B,EAAUC,QACtBmC,IAAMC,IACFN,EAAM/B,EAAUI,KAAKE,SACrB,CACI4B,OAAO,eACAF,EAAQG,SAItBG,MAAK,SAAAC,GACF+F,QAAQC,IAAI,OAAQhG,EAAS7B,MAC7BtC,EAAS,CACLE,KAAM,4BACNkK,SAAUjG,EAAS7B,UAG1B8B,OAAM,SAAAC,GACH6F,QAAQC,IAAI,MAAO9F,GACnBrE,EAAS,CACLE,KAAM,0BACNI,MAAO+D,S,kCEnDRgG,G,OAjBS,SAAAjK,GACpB,IAAMJ,EAAWU,cACT2C,EAAcjD,EAAdiD,UACR,OACI,yBAAK9B,UAAU,kBAAkBE,QAAU,WACnCzB,EAASgD,EAAeK,IACxBrD,EAASF,EAAe,cAE5B,yBAAKyB,UAAU,wBAAwBF,MAAQwF,EAAiBxD,EAAU8E,YAC1E,yBAAK5G,UAAU,2BACX,wBAAIA,UAAU,yBAA0B8B,EAAUnD,MAClD,uBAAGqB,UAAU,wBAAyB8B,EAAUiC,UCQjDgF,G,OAtBM,SAAAlK,GAAU,IACnBmK,EAAenK,EAAfmK,WACR,OACI,kBAAC,IAAD,CAAMhJ,UAAU,gBACVgJ,GAAoC,IAAtBA,EAAWC,OACvBD,EAAWxH,KAAI,SAAAM,GACX,OACI,kBAAC,EAAD,CACIkF,IAAMlF,EAAUnD,KAChBmD,UAAYA,OAKxB,kBAAC,IAAD,KACI,0DCTdoH,EAASC,cA4CAC,GA1CC,SAAAvK,GACZ,IAAMJ,EAAWU,cACXkK,EAAkBnC,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAOyH,mBACpD1B,EAAcT,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAO7C,SAChDuK,EAAepC,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAO0H,gBAJlC,EAKW7F,mBAAS,MALpB,mBAKdmE,EALc,KAKJC,EALI,KAuBrB,OAXAjE,qBAAU,WACNnF,EhBwC0B,WAAkB,IAAjByD,EAAgB,uDAAT,KACtC,OAAO,SAACzD,EAAUC,GACd,IAAM0D,EAAM/B,EAAUC,QACd+B,EAAY3D,IAAW4D,WAAvBD,QACFE,EAASL,EAAM,eAAOG,EAAQG,MAAf,CAAsBN,OAAQA,EAAOH,KAArC,eAA+CM,EAAQG,OAE5EC,IAAMC,IAAIN,EAAM,cAAe,CAC3BG,OAAQA,IAEXI,MAAK,SAAAC,GACFnE,EAAS,CACLE,KAAM,+BACNqK,WAAYpG,EAAS7B,UAG5B8B,OAAM,SAAAC,GACHrE,EAAS,CACLE,KAAM,6BACNI,MAAO+D,QgB1DNyG,CAAmBD,MAC7B,CAAC7K,EAAU6K,IAEjB1F,qBAAU,WACH,IAAMkE,EAAgB,kBAAClJ,EAAD,CAAeE,QAAS,kBAAM+I,EAAY,OAAO9I,MAAO4I,IAChFA,GACHE,EAAYC,KAEX,CAACH,IAGG,kBAAC,IAAD,CAAO5F,GAAIlD,EAAMkD,IACb,kBAAC,IAAD,CACIyH,KAAM,kBAAC,IAAD,CAAmBtJ,QAnBhB,WACjBzB,EAASF,EAAe,YACxBE,EAASwD,EAAgB,SAkBZiH,IAAWO,IAAM,kBAAC,IAAD,MAAuB,kBAAC,IAAD,QAFjD,gDAKgBH,EAAeA,EAAa1J,MAAQ,uEAEpD,kBAAC,EAAD,CAAcoJ,WAAaK,IACzBzB,ICZC8B,GA/BM,SAAA7K,GAAU,IACnBgK,EAAahK,EAAbgK,SADkB,EAEMpF,qBAASoF,GAAWA,EAASc,SAFnC,mBAElBA,EAFkB,KAETC,EAFS,KAG1B,OACI,kBAAC,IAAD,KACI,kBAAC,IAAD,CACI/J,aACI,kBAAC,IAAD,CACIgK,QAAUF,EACV3F,SAAW,WAAQ4F,GAAYD,OAJ3C,+FAUIA,EACI,kBAAC,IAAD,KACI,kBAAC,IAAD,CACIG,IAAI,kKACJC,OAAO,iiCAEP,kBAAC,IAAD,CAAOpL,KAAK,OAAOqL,aAAa,OAGvC,OClBfd,GAASC,cA2CAc,GAzCE,SAAApL,GACb,IAAMJ,EAAWU,cACXC,EAAc8H,aAAY,SAAAC,GAAK,OAAIA,EAAMK,KAAKpI,eAEpD,OADAuJ,QAAQC,IAAI,eAAgBxJ,GAExB,kBAAC,IAAD,CAAO2C,GAAIlD,EAAMkD,IACb,kBAAC,IAAD,CACIyH,KAAM,kBAAC,IAAD,CAAmBtJ,QAAU,kBAAMzB,EAASF,EAAe,WAC5D2K,KAAWO,IAAM,kBAAC,IAAD,MAAuB,kBAAC,IAAD,QAFjD,oBAOIrK,EACI,kBAAC,GAAD,CACIyJ,SAAWzJ,EAAcA,EAAYyJ,SAAW,OAGpD,kBAAC,IAAD,MAGR,kBAAC,IAAD,KACI,kBAAC,IAAD,KACI,kBAAC,IAAD,CACIqB,WAAS,EACTzK,KAAK,KACLS,QAAU,kBAAMzB,EAASF,EAAe,WAH5C,oCASR,kBAAC,IAAD,8J,oBCjBG4L,I,OArBS,SAAAtL,GAAU,IACtBe,EAA+Bf,EAA/Be,MAAOwK,EAAwBvL,EAAxBuL,KAAMC,EAAkBxL,EAAlBwL,cACrB,OACI,yBAAKrK,UAAU,6BACX,yBAAKA,UAAU,wBACX,2BAAG,2BAAKJ,IACR,kBAAC,IAAD,CAAW0K,MAAI,IACf,yBAAKtK,UAAU,6BAA8BoK,EAAOG,KAAgBH,GAAQ,kJAC5E,kBAAC,IAAD,CACI3K,KAAK,IACLyK,WAAS,EACTjK,KAAK,UACLC,QAAUmK,GAJd,wDCkCDG,I,OA1CI,SAAA3L,GAAU,IAAD,EACGA,EAAM0D,OAAzBkI,EADgB,EAChBA,MAAOC,EADS,EACTA,QADS,EAEYjH,oBAAS,GAFrB,mBAEhBkH,EAFgB,KAELC,EAFK,OAGgBnH,oBAAS,GAHzB,mBAGhBoH,EAHgB,KAGHC,EAHG,KAIxB,OACI,yBAAK9K,UAAU,cACX,kBAAC,IAAD,CACIA,UAAU,uBAEV,yBAAKA,UAAU,kCACX,uBAAGA,UAAU,4BAAb,gEACA,kBAAC,IAAD,CACIA,UAAU,oBACV6J,QAAUc,EACV3G,SAAW,kBAAM4G,GAAcD,MAEnC,uBAAG3K,UAAU,4BAAb,wCACA,kBAAC,IAAD,CACIA,UAAU,oBACV6J,QAAUgB,EACV7G,SAAW,kBAAM8G,GAAgBD,QAI3CF,EACE,kBAAC,GAAD,CACI/K,MAAQ,+DACRwK,KAAOK,EACPJ,cAAgB,kBAAMO,GAAcD,MAExC,KACFE,EACE,kBAAC,GAAD,CACIjL,MAAQ,uCACRwK,KAAOM,EACPL,cAAgB,kBAAMS,GAAgBD,MAE1C,QC3BV3B,I,OAASC,eAyDA4B,GAvDA,SAAAlM,GACX,IAAMJ,EAAWU,cACXwC,EAAcuF,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAOD,eAChDqJ,EhBdkB,SAACC,EAAWlK,EAAMyC,EAAgB0H,GAC1D,OAAOD,EAAUzJ,KAAI,SAAAyC,GACjB,OAAOkH,IAAMC,cACTF,EAAejH,EAAEtF,MACjB,CACIqI,IAAK/C,EAAElC,GACPyB,eAAgB,SAACzC,EAAMsK,GAAP,OAAiB7H,EAAeS,EAAElC,GAAIhB,EAAMsK,IAC5DtK,KAAMA,EAAO0E,EAAe1E,EAAMkD,EAAElC,IAAM,KAC1CQ,OAAQ0B,EAAE1B,QAEd,SgBIU+I,CACd3J,EAAYG,UAAUmJ,UACtBtJ,EAAYZ,MACZ,SAACgB,EAAIhB,EAAMsK,GAAX,OAAqB5M,ErBUQ,SAACsD,EAAIwJ,EAAahI,GACnD,OAAO,SAAC9E,EAAUC,GACdD,EAAS,CAAEE,KAAM,2BAA4BoD,GAAIA,EAAIhB,KAAK,eAAGwC,EAAYgI,MqBZ3CC,CAAsBzJ,EAAIhB,EAAMsK,MhBD3D,CACH/H,UAAWA,EACXa,WAAYA,EACZqB,YAAaA,IgBcjB,OAZA5B,qBAAU,WACN,IAAM6H,EAAWC,aACb,WACIjN,EAASsE,OAEb1C,EAAUG,sBACd,OAAO,WACHmL,cAAcF,GACdhN,EAASsE,QAEd,CAACtE,IAGA,kBAAC,IAAD,CAAOsD,GAAIlD,EAAMkD,IACb,kBAAC,IAAD,CACIyH,KAAM,kBAAC,IAAD,CAAmBtJ,QAAU,kBAAMzB,EAASF,EAAe,WAC5D2K,KAAWO,IAAM,kBAAC,IAAD,MAAuB,kBAAC,IAAD,QAFjD,iBAOA,yBAAKzJ,UAAU,sBACX,kBAAC,EAAD,CAAauC,OAAS,CAAE,SAAYZ,EAAYG,UAAU8E,YAC1D,kBAAC,GAAD,CAAYrE,OAAS,CAAE,MAASZ,EAAYG,UAAU2I,MAAO,QAAW9I,EAAYG,UAAU4I,YAElG,kBAAC,IAAD,CAAK1K,UAAU,qBACVgL,GAEL,kBAAC,IAAD,KACI,kBAAC,IAAD,CACId,WAAS,EACTzK,KAAK,KACLS,QAAU,kBAAMzB,EAASF,EAAe,WAH5C,2HCYDqN,I,OA1DM,SAAA/M,GACjB,IAAMJ,EAAWU,cACT2C,EAAcjD,EAAdiD,UACR,OACIA,EACI,kBAAC,IAAM+J,SAAP,KACI,kBAAC,IAAD,CAAK7L,UAAU,0BAA0BF,MAAOwF,EAAgBxD,EAAU8E,YAC1E,kBAAC,IAAD,KACI,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAShH,MAAM,oDACTkC,EAAUnD,OAGpB,kBAAC,IAAD,CAAM0I,WAAS,GACX,kBAAC,IAAD,CAASzH,MAAM,mDAAWH,KAAK,KACzBqC,EAAUiC,OAGpB,kBAAC,IAAD,CAAMsD,WAAS,GACX,kBAAC,IAAD,CAASzH,MAAM,+DAAaH,KAAK,KAC3B8K,KAAgBzI,EAAU2I,SAGpC,kBAAC,IAAD,KACI,kBAAC,IAAD,KACI,kBAAC,IAAD,CACIP,WAAS,EACTzK,KAAK,KACLS,QAAU,WACNzB,EAASgD,EAAe,OACxBhD,EAASF,EAAe,cALhC,mCAWJ,kBAAC,IAAD,KACI,kBAAC,IAAD,CACI2L,WAAS,EACTzK,KAAK,KACLQ,KAAK,YACLC,QAAU,WACNzB,EAASwD,EAAgB,OACzBxD,EAASF,EAAe,aANhC,mDAgBhB,OCrDN2K,GAASC,cAiCA2C,GA/BC,SAAAjN,GACZ,IAAMJ,EAAWU,cACXwC,EAAcuF,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAOD,eAEtD,OACI,kBAAC,IAAD,CAAOI,GAAIlD,EAAMkD,IACb,kBAAC,IAAD,CACIyH,KACI,kBAAC,IAAD,CACItJ,QACI,WACIzB,EAASgD,EAAe,OACxBhD,EAASF,EAAe,cAI/B2K,KAAWO,IAAM,kBAAC,IAAD,MAAuB,kBAAC,IAAD,QAVrD,iBAgBA,kBAAC,GAAD,CAAc3H,UAAYH,EAAcA,EAAYG,UAAY,SC1BtEoH,GAASC,cAgEA4C,GA9DD,SAAAlN,GACV,IAAMJ,EAAWU,cACjB,OACI,kBAAC,IAAD,CAAO4C,GAAIlD,EAAMkD,IACb,kBAAC,IAAD,CACIyH,KAAM,kBAAC,IAAD,CAAmBtJ,QAAU,kBAAMzB,EAASF,EAAe,WAC5D2K,KAAWO,IAAM,kBAAC,IAAD,MAAuB,kBAAC,IAAD,QAFjD,uEAOA,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAMpC,WAAS,GACX,+GACA,0RACA,68CAOA,ukEAOI,qCACI,uBAAGnD,OAAO,SAAS8H,IAAI,sBAAsBC,KAAK,wDAAlD,yCAEJ,qCACI,uBAAG/H,OAAO,SAAS8H,IAAI,sBAAsBC,KAAK,4DAAlD,qDAXR,IAaI,6BAbJ,2JAeA,64BAMJ,kBAAC,IAAD,KACI,kBAAC,IAAD,CACI/B,WAAS,EACTzK,KAAK,KACLS,QAAU,kBAAMzB,EAASF,EAAe,WAH5C,oCASR,kBAAC,IAAD,8B,qBCzBG2N,I,OA5BO,SAAArN,GAClB,IAAMJ,EAAWU,cACT+C,EAAWrD,EAAXqD,OACR,OACI,kBAAC,IAAD,CACIiK,UAAQ,EACRnM,UAAU,gBACVqH,WAAS,EACT/H,OAAQ,kBAAC,IAAD,CAAQQ,MAAQmF,EAAczF,IAAM0C,EAAO0E,WACnDwF,QAAUlK,EAAO6B,KACjBsI,MACI,kBAAC,KAAD,CACInM,QAAU,WACNzB,EAASwD,EAAgBC,IACrBA,EAAOoK,YACP7N,EAASF,EAAe,YAExBE,EAASF,EAAe,gBAMtC2D,EAAOtC,SCPN2M,I,OArBK,SAAA1N,GAAU,IAClBwE,EAAYxE,EAAZwE,QACR,OACI,kBAAC,IAAD,CAAOrD,UAAU,eACXqD,GAA8B,IAAnBA,EAAQ4F,OAAgB5F,EAAQ7B,KAAI,SAAAU,GACzC,OACI,kBAAC,GAAD,CACI8E,IAAM9E,EAAOH,GACbG,OAASA,OAKrB,kBAAC,IAAD,KACI,iDCRdgH,GAASC,cA8DAqD,GA5DC,SAAA3N,GACZ,IAAMJ,EAAWU,cACXkE,EAAU6D,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAOyB,WAC5C0D,EAAUG,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAOmF,WAC5CY,EAAcT,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAO7C,SAChDuK,EAAepC,aAAY,SAAAC,GAAK,OAAIA,EAAMvF,OAAO0H,gBACjDmD,EAAcvF,aAAY,SAAAC,GAAK,OAAIA,EAAM3I,MAAMiO,eANhC,EAOWhJ,mBAAS,MAPpB,mBAOdmE,EAPc,KAOJC,EAPI,KAqCrB,OAfAjE,qBAAU,WACF0F,IAAiBA,EAAagD,aAAehD,EAAalG,QAC1D3E,EAAS0E,EAAgBmG,IAEzB7K,EAAS0E,OAEd,CAAC1E,EAAU6K,EAAcmD,IAE/B7I,qBAAU,WACH,IAAMkE,EAAgB,kBAAClJ,EAAD,CAAeE,QAAS,kBAAM+I,EAAY,OAAO9I,MAAO4I,IAChFA,GACHE,EAAYC,KAEX,CAACH,IAGG,kBAAC,IAAD,CAAO5F,GAAIlD,EAAMkD,IACb,kBAAC,IAAD,CACIyH,KAAM,kBAAC,IAAD,CAAmBtJ,QA/BhB,WACboJ,IAAiBA,EAAagD,aAAehD,EAAalG,SACtDkG,EAAalG,OACb3E,EAASwD,EAAgBqH,EAAalG,SAEtC3E,EAASwD,EAAgB,OAE7BxD,EAASF,EAAe,aAExBE,EAASF,EAAe,WAuBf2K,KAAWO,IAAM,kBAAC,IAAD,MAAuB,kBAAC,IAAD,QAFjD,oBAKuBH,EAAeA,EAAa1J,MAAQ,sBAEzDmH,EACE,kBAAC,IAAD,CAAStH,KAAK,QAAQO,UAAU,sBAEhC,kBAAC,GAAD,CAAaqD,QAAUA,IAEzBuE,ICfC8E,I,cAlCH,SAAA7N,GACX,IAAMJ,EAAWU,cACXsN,EAAcvF,aAAY,SAAAC,GAAK,OAAIA,EAAM3I,MAAMiO,eAC/CE,EAAQzF,aAAY,SAAAC,GAAK,OAAIA,EAAMwF,MAAMA,SACzCtK,EAAU6E,aAAY,SAAAC,GAAK,OAAIA,EAAM7E,WAAWD,WAChDwE,EAASK,aAAY,SAAAC,GAAK,OAAIA,EAAMN,OAAOA,UAOjD,OALAjD,qBAAU,WACTnF,GCtBS,SAACA,EAAUC,GACd,IAAMkO,EAAmB,SAACC,GACtB,OAAOA,EAAOC,MAAM,GAAGC,MAAM,KACxBvL,KAAI,SAACwL,GACF,IAAIC,EAAMD,EAAWD,MAAM,KAC3B,MAAO,CAAC/F,IAAKiG,EAAI,GAAIvJ,MAAOuJ,EAAI,OAEnCC,QAAO,SAAC1K,EAAOyK,GAEZ,OADAzK,EAAMyK,EAAIjG,KAAOiG,EAAIvJ,MACdlB,IACR,KAEL2K,EAAcP,EAAiBQ,OAAOC,SAASC,QAC/CC,EAAaX,EAAiBQ,OAAOC,SAASG,MAEpDL,EAAYM,yBAA2BC,mBAAmBP,EAAYM,0BACtEhP,EAAS,CAAEE,KAAM,eAAgB6D,MAAO2K,EAAaK,KAAMD,ODOjE9O,GhBlBS,SAACA,EAAUC,GACdiP,IAAUC,YAAY,sBAAuB,IAC5CjL,MAAK,SAAA5B,GACFtC,EAAS,CAAEE,KAAM,sBAAuB6I,KAAMzG,IAC9CtC,EAASsJ,QAEZlF,OAAM,SAAAC,GACHrE,EAAS,CAAEE,KAAM,oBAAqBI,MAAO+D,YgBYrD,CAACrE,IAEA4D,EAEF,kBAAC,IAAD,CAAMwE,OAAQA,EAAQ8F,MAAOA,EAAOF,YAAaA,GAChD,kBAAC,GAAD,CAAO1K,GAAG,UACV,kBAAC,GAAD,CAAiBA,GAAG,oBACpB,kBAAC,EAAD,CAAMA,GAAG,SACT,kBAAC,GAAD,CAASA,GAAG,YACZ,kBAAC,GAAD,CAASA,GAAG,YACZ,kBAAC,GAAD,CAASA,GAAG,YACZ,kBAAC,GAAD,CAAQA,GAAG,YAKZ,6BACC,kBAAC,IAAD,CAAStC,KAAK,QAAQK,MAAO,CAAE+N,UAAW,MAC1C,kBAAC,IAAD,qF,mBE3CEC,GAAY,CACdrB,YAAa,QAYFsB,GATM,WAA8B,IAA7B5G,EAA4B,uDAAtB2G,GAAW/H,EAAW,uCAC9C,OAAQA,EAAOpH,MACX,IAAK,mBACD,MAAO,CAAC8N,YAAa1G,EAAOvH,OAChC,QACI,OAAO2I,ICTb2G,GAAY,CACdzL,QAAS,MAkBE2L,GAfW,WAA8B,IAA7B7G,EAA4B,uDAAtB2G,GAAW/H,EAAW,uCACnD,OAAQA,EAAOpH,MACX,IAAK,eACD,OAAO,eACAwI,EADP,CAEI9E,QAAS,CACLG,MAAOuD,EAAOvD,MACdgL,KAAMzH,EAAOyH,QAGzB,QACI,OAAOrG,ICfb2G,GAAY,CACd1O,YAAa,KACbL,MAAO,MA6CIkP,GA1CK,WAA8B,IAA7B9G,EAA4B,uDAAtB2G,GAAW/H,EAAW,uCAC7C,OAAQA,EAAOpH,MACX,IAAK,sBACD,OAAO,eACAwI,EADP,CAEI/H,YAAY,eACL+H,EAAM/H,YADF,CAEPC,QAAS0G,EAAOyB,SAG5B,IAAK,oBACD,OAAO,eACAL,EADP,CAEIpI,MAAOgH,EAAOhH,QAEtB,IAAK,yBACD,OAAO,eACAoI,GAEX,IAAK,uBACD,OAAO,eACAA,EADP,CAEIpI,MAAOgH,EAAOhH,QAEtB,IAAK,4BACD,OAAO,eACAoI,EADP,CAEI/H,YAAY,eACL+H,EAAM/H,YADF,CAEPyJ,SAAU9C,EAAO8C,aAG7B,IAAK,0BACD,OAAO,eACA1B,EADP,CAEIpI,MAAOgH,EAAOhH,QAEtB,QACI,OAAOoI,IC3Cb2G,GAAY,CACdnB,MAAO,MAcIuB,GAXM,WAA8B,IAA7B/G,EAA4B,uDAAtB2G,GAAW/H,EAAW,uCAC9C,OAAQA,EAAOpH,MACX,IAAK,aACD,MAAO,CAACgO,MAAO5G,EAAO4G,OAC1B,IAAK,cACD,MAAO,CAACA,MAAO,MACnB,QACI,OAAOxF,ICTb2G,GAAY,CACdnM,YAAa,KACb+F,aAAc,KACd2B,gBAAiB,KACjBhG,QAAS,KACT8K,aAAc,KACd7E,aAAc,KACdvK,MAAO,KACPgI,SAAS,GA6GEqH,GA1GO,WAA8B,IAA7BjH,EAA4B,uDAAtB2G,GAAW/H,EAAW,uCAC/C,OAAQA,EAAOpH,MACX,IAAK,mBACD,OAAO,eACAwI,EADP,CAEIxF,YAAaoE,EAAO/D,OAAS+D,EAAO/D,MAAMF,UAA7B,eACNiE,EAAO/D,OACT,OAEb,IAAK,oBACD,OAAO,eACAmF,EADP,CAEImC,aAAcvD,EAAO7D,OAAP,eACP6D,EAAO7D,QACT,OAEb,IAAK,2BACD,OAAO,eACAiF,EADP,CAEIxF,YAAY,eACLwF,EAAMxF,YADF,CAEPZ,KAAK,eACEoG,EAAMxF,YAAYZ,KADrB,eAECgF,EAAOhE,GAAMgE,EAAOhF,WAIrC,IAAK,4BACD,OAAO,eACAoG,EADP,CAEIJ,SAAS,EACThI,MAAO,KACP2I,aAAc3B,EAAOnE,OAAOJ,KAAI,SAAAQ,GAC5B,OAAO,eACAA,EADP,CAEIjB,KAAMF,EAAkBmB,EAAMjB,aAI9C,IAAK,yBACD,OAAO,eACAoG,EADP,CAEIJ,SAAS,EACThI,MAAOgH,EAAOhH,QAEtB,IAAK,+BACD,OAAO,eACAoI,EADP,CAEIpI,MAAO,KACPgI,SAAS,EACTsC,gBAAiBtD,EAAOiD,aAEhC,IAAK,4BACD,OAAO,eACA7B,EADP,CAEIpI,MAAO,KACP4C,YAAY,eACLoE,EAAO/D,MADH,CAEPjB,KAAMF,EAAkBkF,EAAO/D,MAAMjB,UAGjD,IAAK,0BACD,OAAO,eACAoG,EADP,CAEIpI,MAAOgH,EAAOhH,QAEtB,IAAK,6BACD,OAAO,eACAoI,EADP,CAEIJ,SAAS,EACThI,MAAOgH,EAAOhH,QAEtB,IAAK,uBACD,OAAO,eACAoI,EADP,CAEIpI,MAAO,KACP4C,YAAawF,EAAMxF,aAAgBwF,EAAMxF,YAAYI,KAAOgE,EAAOhE,GAAM,KAAOoF,EAAMxF,cAE9F,IAAK,qBACD,OAAO,eACAwF,EADP,CAEIpI,MAAOgH,EAAOhH,QAEtB,IAAK,4BACD,OAAO,eACAoI,EADP,CAEIpI,MAAO,KACPgI,SAAS,EACT1D,QAAS0C,EAAO1C,UAExB,IAAK,0BACD,OAAO,eACA8D,EADP,CAEIJ,SAAS,EACThI,MAAOgH,EAAOhH,QAEtB,IAAK,cACD,OAAO,eACAoI,EADP,CAEIJ,SAAS,IAEjB,QACI,OAAOI,ICnHb2G,GAAY,CACdjH,OAAQ,MAcGwH,GAXO,WAA8B,IAA7BlH,EAA4B,uDAAtB2G,GAAW/H,EAAW,uCAC/C,OAAQA,EAAOpH,MACX,IAAK,cACD,MAAO,CAACkI,OAAQd,EAAOc,QAC3B,IAAK,eACD,MAAO,CAACA,OAAQ,MACpB,QACI,OAAOM,ICMJmH,GATKC,aAAgB,CAChC/P,MAAOuP,GACPzL,WAAY0L,GACZxG,KAAMyG,GACNtB,MAAOuB,GACPtM,OAAQwM,GACRvH,OAAQwH,KCLGG,GANS,SAAC,GAAD,IAAGC,EAAH,EAAGA,SAAUC,EAAb,EAAaA,MAAb,OACpB,kBAAC,IAAD,CAAUA,MAAOA,GACXD,ICSVd,IAAUgB,KAAK,eAAgB,IAE/B,IAAMD,GAAQE,aACVN,GACAO,aAAgBC,OAGdC,GAAiB,kBACnB,kBAACC,GAAD,CAAiBN,MAAQA,IACrB,kBAAC,GAAD,QAIRO,IAASC,OACL,kBAAC,GAAD,MAAoBvK,SAASwK,eAAe,W","file":"static/js/main.e681d120.chunk.js","sourcesContent":["export const setActivePanel = (panel) => {\n    return (dispatch, getState) => {\n        dispatch({ type: \"SET_ACTIVE_PANEL\", panel: panel })\n    }\n};","import React from 'react'\nimport { Snackbar } from '@vkontakte/vkui';\n\nexport default function ErrorSnackbar(props) {\n    const { onClose, error } = props;\n    return (\n        <Snackbar\n                layout=\"vertical\"\n                onClose={ onClose }\n            >\n                <p>{ error ? error.toString() : \"Everything is OK\" }</p>\n        </Snackbar>\n    )\n}\n\n","import React from 'react';\nimport { Group, Cell, Avatar, Button } from '@vkontakte/vkui';\nimport { useDispatch } from 'react-redux';\nimport { setActivePanel } from '../../store/actions/panelActions';\nimport \"./UserSnippet.css\";\n\n\nconst UserSnippet = props => {\n\tconst dispatch = useDispatch();\n    const { currentUser } = props;\n    return (currentUser && currentUser.profile &&\n\t\t<Group>\n\t\t\t<Cell\n\t\t\t\tbefore={ currentUser.profile.photo_200 ? <Avatar src={ currentUser.profile.photo_200 }/> : null }\n\t\t\t\tsize=\"l\"\n\t\t\t\tdescription={ currentUser.profile.city && currentUser.profile.city.title ? currentUser.profile.city.title : '' }\n\t\t\t\tasideContent={\n\t\t\t\t\t<div style={ { display: 'flex' } }>\n\t\t\t\t\t\t<Button \n\t\t\t\t\t\t\tclassName=\"UserSnippet-button\"\n\t\t\t\t\t\t\tmode=\"tertiary\"\n\t\t\t\t\t\t\tonClick={ () => dispatch(setActivePanel(\"about\")) } \n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tО приложении\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button \n\t\t\t\t\t\t\tclassName=\"UserSnippet-button\"\n\t\t\t\t\t\t\tmode=\"tertiary\"\n\t\t\t\t\t\t\tonClick={ () => dispatch(setActivePanel(\"profilesettings\")) } \n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tПрофиль \n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t>\n\t\t\t\t{`${currentUser.profile.first_name} ${currentUser.profile.last_name}`}\n\t\t\t</Cell>\n\t\t</Group>\n    )\n}\n\nexport default UserSnippet;","const appConfig = {\n    API_URL: \"https://smart-sheets-backend.appspot.com/api/rest/\",\n    DEFAULT_DATA_FIELD: \"content\",\n    EDITOR_SAVE_INTERVAL: 1000 * 50,\n    urls: {\n        PROFILE: 'accounts/profile',\n        SETTINGS: 'accounts/settings',\n        RUBRICS: 'rubrics/',\n    },\n};\n\nexport default appConfig;","export const dataArrayToObject = (dataArray) => {\n    let data = {}\n    dataArray && dataArray.forEach(d => {\n        data[d.elementId] = d.content\n    });\n    return data;\n}\n\nexport const dataObjectToArray = (dataObject) => {\n    return Object.entries(dataObject).map(([key, value]) => {\n        return {\n            elementId: key,\n            content: value\n        }\n    });\n}\n\n// const combinations = (A, k) => {\n// \tlet n = A.length\n// \tlet res = [];\n// \tif (k > n) {\n// \t\treturn res\n// \t} else if (k === n) {\n// \t\tres.push(A)\n// \t\treturn res\n// \t}\n// \tlet indices = Array.from({ length: k }, (_, i) => i);\n// \tres.push(indices.map(i => A[i]));\n// \tlet iter = 0\n// \twhile (iter < 20) {\n// \t\tfor (var i in Array.from({ length: k }, (_, i) => i).reverse()) {\n// \t\t\tif (indices[i] != i+n-k) {\n// \t\t\t\tbreak\n// \t\t\t} else {\n// \t\t\t\treturn res\n// \t\t\t}\n// \t\t\tindices[i] = indices[i]+1;\n// \t\t\tfor (var j; j>=i+1 && j<k; j++) {\n// \t\t\t\tindices[j] = indices[j-1]+1;\n// \t\t\t}\n// \t\t\tres.push(indices.map(i => A[i]));\n// \t\t}\n// \t\tconsole.log(iter);\n// \t\titer++;\n// \t}\n// \treturn res\n// }\n\n// console.log(combinations([\"A\", \"B\", \"C\", \"D\"], 3))\n\n/* def combinations(A, r):\n    pool = tuple(A)\n    n = len(pool)\n    res = []\n    if r > n:\n        return res\n    indices = list(range(r))\n    res.append(tuple(pool[i] for i in indices))\n    while True:\n        for i in reversed(range(r)):\n            if indices[i] != i + n - r:\n                break\n        else:\n            return res\n        indices[i] += 1\n        for j in range(i+1, r):\n            indices[j] = indices[j-1] + 1\n        res.append(tuple(pool[i] for i in indices))\n    return res */","import appConfig from \"../../config/appConfig\"\nimport axios from 'axios';\nimport { dataObjectToArray } from \"../../utils/arrayUtils\";\n\nexport const setActiveSheet = (sheetOrBlueprint) => {\n    return (dispatch, getState) => {\n        const { activeSheet } = getState().sheets;\n        let newSheet = null;\n        if (sheetOrBlueprint && sheetOrBlueprint.blueprint) { // if we have sheet\n            newSheet = activeSheet && activeSheet.id && (activeSheet.id === sheetOrBlueprint.id) ? activeSheet : sheetOrBlueprint;\n        } else { // if we have blueprint\n            newSheet = {};\n            newSheet['blueprint'] = sheetOrBlueprint;\n        }\n        \n        dispatch({\n            type: \"SET_ACTIVE_SHEET\",\n            sheet: newSheet,\n        })\n    }\n};\n\nexport const setActiveRubric = (rubric) => {\n    return (dispatch, getState) => {\n        // const { activeRubric } = getState().sheets; // just in case\n        \n        dispatch({\n            type: \"SET_ACTIVE_RUBRIC\",\n            rubric: rubric,\n        })\n    }\n};\n\nexport const updateActiveSheetData = (id, dataContent, dataField) => {\n    return (dispatch, getState) => {\n        dispatch({ type: \"UPDATE_ACTIVE_SHEET_DATA\", id: id, data: {[dataField]: dataContent} });\n    }\n};\n\nexport const getRecentSheets = () => {\n    return (dispatch, getState) => {\n\n        dispatch({type: \"SET_LOADING\"});\n\n        const url = appConfig.API_URL;\n        const { vkquery } = getState().validation;\n        const params = {...vkquery.query}       \n\n        axios.get(url + \"sheets/\", {\n            params: params\n        })\n        .then(response => {\n            dispatch({\n                type: \"GET_RECENT_SHEETS_SUCCESS\",\n                sheets: response.data\n            })\n        })\n        .catch(err => {\n            dispatch({\n                type: \"GET_RECENT_SHEET_ERROR\",\n                error: err\n            })\n        });\n    }\n}\n\nexport const getSheetBlueprints = (rubric=null) => {\n    return (dispatch, getState) => {\n        const url = appConfig.API_URL;\n        const { vkquery } = getState().validation;\n        const params = rubric ? {...vkquery.query, rubric: rubric.id} : {...vkquery.query}       \n\n        axios.get(url + \"blueprints/\", {\n            params: params\n        })\n        .then(response => {\n            dispatch({\n                type: \"GET_SHEET_BLUEPRINTS_SUCCESS\",\n                blueprints: response.data\n            })\n        })\n        .catch(err => {\n            dispatch({\n                type: \"GET_SHEET_BLUEPRINTS_ERROR\",\n                error: err\n            })\n        });\n    }\n}\n\nexport const postActiveSheet = () => {\n    return (dispatch, getState) => {\n        const url = appConfig.API_URL;\n        const { activeSheet } = getState().sheets;\n        const { vkquery } = getState().validation;\n\n        if (activeSheet && activeSheet.id) { // update sheet\n            axios.put( // maybe refactor later : only method and url are different\n                url + 'sheets/' + activeSheet.id + \"/\", \n                {\n                    blueprintId: activeSheet.blueprint.id,\n                    data: dataObjectToArray(activeSheet.data)\n                },\n                {\n                    params:  {...vkquery.query}   \n                }\n            ).then(response => {\n                dispatch({ type: \"POST_ACTIVE_SHEET_SUCCESS\", sheet: response.data });   \n                dispatch(getRecentSheets()) // maybe use didInvalidate property in state\n            }).catch(err => {\n                dispatch({ type: \"POST_ACTIVE_SHEET_ERROR\", error: err });\n            });\n        } else if (activeSheet) { // create sheet\n            axios.post(\n                url + 'sheets/',\n                {\n                    blueprintId: activeSheet.blueprint.id,\n                    data: dataObjectToArray(activeSheet.data)\n                },   \n                {\n                    params:  {...vkquery.query}   \n                }           \n            ).then(response => {\n                dispatch({ type: \"POST_ACTIVE_SHEET_SUCCESS\", sheet: response.data });   \n                dispatch(getRecentSheets()) // maybe use didInvalidate property in state\n            }).catch(err => {\n                dispatch({ type: \"POST_ACTIVE_SHEET_ERROR\", error: err });\n            });\n        }\n    }\n};\n\nexport const deleteSheet = (sheet) => {\n    return (dispatch, getState) => {\n        const url = appConfig.API_URL;\n        const { vkquery } = getState().validation;\n        axios.put( // maybe refactor later \n            \n            url + 'sheets/' + sheet.id + \"/\", \n            {\n                blueprintId: sheet.blueprint.id,\n                data: dataObjectToArray(sheet.data),\n                deleted: true\n            },\n            {\n                params:  {...vkquery.query}   \n            }\n        ).then(response => {\n            dispatch({ type: \"DELETE_SHEET_SUCCESS\", id: sheet.id });   \n            dispatch(getRecentSheets()) // maybe use didInvalidate property in state\n        }).catch(err => {\n            dispatch({ type: \"DELETE_SHEET_ERROR\", error: err });\n        });\n    }\n}\n\nexport const getSheetRubrics = (parent=null) => {\n    return (dispatch, getState) => {\n        dispatch({type: \"SET_LOADING\"});\n\n        const url = appConfig.API_URL;\n        const { vkquery } = getState().validation;\n        const params = parent ? {...vkquery.query, parent: parent.id} : {...vkquery.query};  \n\n        axios.get(url + appConfig.urls.RUBRICS, {\n            params: params\n        })\n        .then(response => {\n            dispatch({\n                type: \"GET_SHEET_RUBRICS_SUCCESS\",\n                rubrics: response.data\n            })\n        })\n        .catch(err => {\n            dispatch({\n                type: \"GET_SHEET_RUBRICS_ERROR\",\n                error: err\n            })\n        });\n    }\n}","import React, { useState, useEffect } from 'react';\nimport { FormLayout, Textarea } from '@vkontakte/vkui';\nimport appConfig from '../../config/appConfig';\nimport './TextFrame.css';\n\nconst TextFrame = props => {\n    const dataField = appConfig.DEFAULT_DATA_FIELD;\n    const { params, data, updateFunction } = props;\n    const [ value, setValue ] = useState(data ? data[dataField] : \"\");\n\n    useEffect(() => {\n        updateFunction(value, dataField);\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [value, dataField])\n\n    return (\n        <div className=\"TextFrame\">\n            <FormLayout>\n                <div className=\"TextFrame-header\">\n                    { params.imageURL && (\n                        <div className=\"TextFrame-header-image\">\n                            <img src={ params.imageURL } alt=\"\" />\n                        </div>\n                    ) }\n                    <div className=\"TextFrame-header-text\">\n                        { params.title ? (<h2>{ params.title }</h2>) : null }\n                        { params.desc ? (<h3>{ params.desc }</h3>) : null }\n                    </div>\n                </div>\n                <div className=\"TextFrame-textarea-wrap\"> \n                    <Textarea\n                        value={ value }\n                        onChange={ e => setValue(e.target.value) }\n                    />\n                </div>\n            </FormLayout>\n        </div>\n    )\n}\n\nexport default TextFrame","import React, { useState, useRef, useEffect } from \"react\";\nimport appConfig from \"../../config/appConfig\";\nimport \"./SheetTitle.css\"\n\nconst SheetTitle = props => {\n    const dataField = appConfig.DEFAULT_DATA_FIELD;\n    const { params, data, updateFunction } = props;\n    const inputRef = useRef(null);\n    const [inputVisible, setInputVisible] = useState(false);\n    const [value, setValue] = useState(data ? data[dataField] : params.title);\n    const onClickOutSide = (e) => {\n        if (inputRef.current && !inputRef.current.contains(e.target)) {\n            setInputVisible(false); // Disable text input\n        }\n    };\n    const onClickInside = e => {\n        setInputVisible(true);\n    };\n\n    useEffect(() => {\n        if (inputVisible) {\n            document.addEventListener(\"mousedown\", onClickOutSide);\n        }\n        return () => {\n            document.removeEventListener(\"mousedown\", onClickOutSide);\n        };\n    });\n\n    useEffect(() => {\n        updateFunction(value, dataField);\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [value, dataField])\n\n    return (\n        <div className=\"SheetTitle\">\n            {inputVisible ? (\n                <input \n                    autoFocus\n                    ref={ inputRef }\n                    value={ value } \n                    onChange={ e => setValue(e.target.value) }\n                    placeholder=\"Введите название листочка\"\n                />\n            ) : (\n                <h1 onClick={ onClickInside }>{ value ? value : params.title }</h1>\n            )}\n        </div>\n    )\n}\n\nexport default SheetTitle","export const avatarStyle = {\n    maxHeight: \"100%\",\n    maxWidth: \"100%\",\n    objectFit: \"cover\",\n    objectPosition: \"center\",\n};\n\nexport const backgroundImage = image => {\n    return {\n        backgroundImage: `url(${image})`\n    }\n}","import React from 'react';\n// import { Div } from '@vkontakte/vkui';\nimport { backgroundImage } from '../../styles/inline';\nimport \"./SheetHeader.css\";\n\nconst SheetHeader = props => {\n    const { params } = props\n    return params.imageURL ? (\n        <div className=\"SheetHeader-image-wrap\" style={ backgroundImage(params.imageURL) }></div>\n    ) : null\n}\n\nexport default SheetHeader","import React from 'react';\nimport TextFrame from \"../components/sheets/TextFrame\"\nimport SheetTitle from \"../components/sheets/SheetTitle\"\nimport SheetHeader from '../components/sheets/SheetHeader';\nimport appConfig from '../config/appConfig';\n\nconst buildSheetStructure = (structure, data, updateFunction, elementMapping) => {\n    return structure.map(e => {\n        return React.createElement(\n            elementMapping[e.type], // element\n            { // props\n                key: e.id,\n                updateFunction: (data, field) => updateFunction(e.id, data, field),\n                data: data ? getElementData(data, e.id) : null,\n                params: e.params,\n            },\n            null // children\n        )\n    })\n}\n\nconst getElementMapping = () => {\n    return {\n        TextFrame: TextFrame,\n        SheetTitle: SheetTitle,\n        SheetHeader: SheetHeader,\n    }\n}\n\nconst getElementData = (dataObject, elementId) => {\n    return dataObject[elementId];\n}\n\nconst getSheetTitle = (sheet, titleField=appConfig.DEFAULT_DATA_FIELD) => {\n    const elementData = getElementData(sheet.data, sheet.blueprint.titleElementId)\n    return elementData ? elementData[titleField] : null;\n}\n\nconst newDataObject = (elementId, content) => {\n    return {\n        elementId: elementId,\n        content: content\n    }\n}\n\nexport {buildSheetStructure, getElementMapping, getElementData, getSheetTitle, newDataObject}","import React from 'react'\nimport { Alert } from '@vkontakte/vkui'\n\nconst ConfirmationPopout = props => {\n    const { onClose, action, title, message } = props;\n    return (\n        <Alert\n            actionsLayout=\"vertical\"\n            actions={[{\n                title: title,\n                autoclose: true,\n                mode: 'destructive',\n                action: action,\n            }, {\n                title: 'Отмена',\n                autoclose: true,\n                mode: 'cancel'\n            }]}\n            onClose={ () => onClose() }\n        >\n            <h2>Подтвердите действие</h2>\n            <p>{ message }</p>\n        </Alert>\n    )\n}\n\nexport default ConfirmationPopout;","import React from 'react';\nimport moment from 'moment';\nimport { Cell, Avatar, Button } from '@vkontakte/vkui';\nimport Icon24Write from '@vkontakte/icons/dist/24/write';\nimport Icon24Delete from '@vkontakte/icons/dist/24/delete';\nimport { setActivePanel } from '../../store/actions/panelActions';\nimport { useDispatch } from 'react-redux';\nimport { setActiveSheet, deleteSheet } from '../../store/actions/sheetsActions';\nimport { getSheetTitle } from '../../utils/sheetsBuilder';\nimport { openPopout, closePopout } from '../../store/actions/popoutActions';\nimport ConfirmationPopout from '../interface/ConfirmationPopout';\nimport { avatarStyle } from '../../styles/inline';\nimport \"./SheetSnippet.css\";\n\n\nconst SheetSnippet = props => {\n    const dispatch = useDispatch();\n    const { sheet } = props;\n    const sheetTitle = getSheetTitle(sheet);\n    const confirmDeletePopout = <ConfirmationPopout\n        onClose={ () => dispatch(closePopout()) }\n        action={ () => dispatch(deleteSheet(sheet)) }\n        title=\"Удаление листочка\"\n        message=\"Удалить этот листочек?\"\n    />\n    const updated = moment(sheet.updated).format('DD.MM.YYYY hh:mm');\n\n    return (\n        <div className=\"SheetSnippet\">\n            <Cell\n                before={\n                    sheet.blueprint.imageUrl && <Avatar \n                        className=\"SheetSnippet-avatar\"\n                        type=\"image\"\n                        src={ sheet.blueprint.imageUrl } \n                        style={ avatarStyle }\n                    />\n                }\n                description={ sheet.blueprint.type + \" | \" + updated }\n                asideContent={\n                    <div className=\"SheetSnippet-controls\">\n                        <Button \n                            before={<Icon24Write />}\n                            onClick={ () => {\n                                dispatch(setActiveSheet(sheet));\n                                dispatch(setActivePanel(\"editor\"));\n                            } }\n                        >\n                            Edit\n                        </Button>\n                        <Button \n                            before={<Icon24Delete />}\n                            onClick= { () => dispatch(openPopout(confirmDeletePopout)) }\n                        >\n                            Delete\n                        </Button>\n                    </div>\n                }\n            >\n                { sheetTitle } \n            </Cell>\n        </div>\n    )\n}\n\nexport default SheetSnippet;","export const openPopout = (popout) => {\n    return (dispatch, getState) => {\n        dispatch({ type: \"OPEN_POPOUT\", popout: popout })\n    }\n};\n\nexport const closePopout = () => {\n    return (dispatch, getState) => {\n        dispatch({ type: \"CLOSE_POPOUT\" })\n    }\n};","import React from 'react';\nimport { List, Spinner, Cell } from '@vkontakte/vkui';\nimport SheetSnippet from './SheetSnippet';\nimport \"./SheetList.css\";\n\n\nconst SheetList = props => {\n    const { sheets, loading } = props;\n    return (\n        <List>\n            { loading ? (\n                <Spinner size=\"large\" className=\"SheetList-spinner\" />\n            ) : (\n                null\n            ) }\n            \n            { sheets ? sheets.map(sheet => {\n                return (\n                    <SheetSnippet\n                        key={ sheet.id }\n                        sheet={ sheet }\n                    />\n                )\n            })\n             : (\n                <Cell>No sheets yet</Cell>\n            ) }\n        </List>\n    )\n}\n\nexport default SheetList","import React from 'react';\nimport { Group, Avatar, Cell, Button, Header } from '@vkontakte/vkui';\nimport { setActivePanel } from '../../store/actions/panelActions';\nimport { getSheetTitle } from '../../utils/sheetsBuilder';\nimport { avatarStyle } from '../../styles/inline';\nimport { useSelector, useDispatch } from 'react-redux';\n\nconst ActiveSheetSnippet = props => {\n    const dispatch = useDispatch();\n    const activeSheet = useSelector(state => state.sheets.activeSheet);\n    return (\n        activeSheet ? (\n            <Group header={<Header mode=\"secondary\">Активный листочек</Header>}>\n                <Cell \n                    before={\n                        <Avatar \n                            size={72} \n                            src={activeSheet.blueprint.imageUrl}\n                            style={ avatarStyle }\n                        />\n                    }\n                    multiline\n                    size='l'\n                    description={ \n                        activeSheet.blueprint.type\n                    }\n                    bottomContent={\n                        <div>\n                            <Button onClick={ () => dispatch(setActivePanel(\"editor\")) }>Продолжить</Button>\n                        </div>\n                    }\n                >\n                    { getSheetTitle(activeSheet) }\n                </Cell>\n            </Group>\n        ) : (\n            null\n        )\n    )\n}\n\nexport default ActiveSheetSnippet;","import React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Panel, Group, PanelHeader, Div, Button, Footer } from '@vkontakte/vkui';\nimport { setActivePanel } from '../store/actions/panelActions';\nimport { useSelector, useDispatch } from 'react-redux';\nimport ErrorSnackbar from '../components/interface/ErrorSnackbar';\nimport UserSnippet from '../components/user/UserSnippet';\nimport SheetList from '../components/sheets/SheetList';\nimport ActiveSheetSnippet from '../components/sheets/ActiveSheetSnippet';\nimport { getRecentSheets } from '../store/actions/sheetsActions';\n\nconst Home = (props) => {\n\tconst { id } = props;\n\n\tconst dispatch = useDispatch();\n\tconst currentUser = useSelector(state => state.user.currentUser);\n\tconst recentSheetsLoading = useSelector(state => state.sheets.loading);\n\tconst recentSheets = useSelector(state => state.sheets.recentSheets);\n\tconst sheetsError = useSelector(state => state.sheets.error);\n\tconst [snackbar, setSnackbar] = useState(null);\n\t\n\tuseEffect(() => {\n\t\tconst errorSnackbar = <ErrorSnackbar onClose={() => setSnackbar(null)} error={sheetsError} />\n\t\tif (sheetsError) {\n\t\t\tsetSnackbar(errorSnackbar)\n\t\t}\n\t}, [sheetsError])\n\n\tuseEffect(() => {\n\t\tdispatch(getRecentSheets());\n\t}, [dispatch])\n\n\treturn (\n\t\t<Panel id={id}>\n\t\t\t<PanelHeader>Умные Листочки</PanelHeader>\n\t\t\t<UserSnippet currentUser={ currentUser } />\n\t\t\t<ActiveSheetSnippet />\n            <Group>\n\t\t\t\t<Div>\n\t\t\t\t\t<Button \n\t\t\t\t\t\tsize=\"xl\" \n\t\t\t\t\t\tmode=\"secondary\"\n\t\t\t\t\t\tonClick={ () => dispatch(setActivePanel(\"rubrics\")) } \n\t\t\t\t\t>\n\t\t\t\t\t\t{ \"Add new Smart Sheet\" } \n\t\t\t\t\t</Button>\n\t\t\t\t</Div>\n\t\t\t\t<SheetList sheets={ recentSheets } loading={ recentSheetsLoading } />\n            </Group>\t\n\t\t\t<Footer>Write for happiness</Footer>\n\t\t\t{ snackbar }\n\t\t</Panel>\n\t)\n};\n\nHome.propTypes = {\n\tid: PropTypes.string.isRequired,\n\tfetchedUser: PropTypes.shape({\n\t\tphoto_200: PropTypes.string,\n\t\tfirst_name: PropTypes.string,\n\t\tlast_name: PropTypes.string,\n\t\tcity: PropTypes.shape({\n\t\t\ttitle: PropTypes.string,\n\t\t}),\n\t}),\n};\n\nexport default Home;","import appConfig from \"../../config/appConfig\"\nimport axios from 'axios';\nimport vkconnect from '@vkontakte/vk-connect';\nimport { getAgeFromBDate } from \"../../utils/dateUtils\";\n\nexport const getCurrentUser = () => {\n    return (dispatch, getState) => {\n        vkconnect.sendPromise('VKWebAppGetUserInfo', {})\n        .then(data => {\n            dispatch({ type: \"GET_VK_USER_SUCCESS\", user: data });\n            dispatch(sendCurrentUserData()); // save user data to backend\n        })\n        .catch(err => {\n            dispatch({ type: \"GET_VK_USER_ERROR\", error: err });\n        });\n    }\n};\n\nexport const sendCurrentUserData = () => {\n    return (dispatch, getState) => {\n        const { profile } = getState().user.currentUser;\n        const age = getAgeFromBDate(profile.bdate);\n        const userData = {\n            age: age ? age : undefined,\n            sex: profile.sex ? profile.sex : undefined,\n            city: profile.city ? profile.city.title : undefined,\n            timezone: profile.timezone ? profile.timezone : undefined,\n            country: profile.country ? profile.country.title : undefined,\n        };\n        const { vkquery } = getState().validation;\n        const url = appConfig.API_URL;\n        axios.post(\n            url + appConfig.urls.PROFILE,\n            userData, \n            {\n                params: {\n                    ...vkquery.query,\n                }\n            }\n        )\n        .then(response => {\n            dispatch({ type: \"SEND_USER_DATA_SUCCESS\" });\n            dispatch(getCurrentUserSettings());\n        })\n        .catch(err => {\n            dispatch({\n                type: \"SEND_USER_DATA_ERROR\",\n                error: err\n            })\n        });\n    }\n};\n\nconst getCurrentUserSettings = () => {\n    return (dispatch, getState) => {\n        const { vkquery } = getState().validation;\n        const url = appConfig.API_URL;\n        axios.get(\n            url + appConfig.urls.SETTINGS, \n            {\n                params: {\n                    ...vkquery.query,\n                }\n            }\n        )\n        .then(response => {\n            console.log(\"RESP\", response.data)\n            dispatch({\n                type: \"GET_USER_SETTINGS_SUCCESS\",\n                settings: response.data,\n            })\n        })\n        .catch(err => {\n            console.log(\"ERR\", err)\n            dispatch({\n                type: \"GET_USER_SETTINGS_ERROR\",\n                error: err\n            })\n        });\n    }\n}","import moment from \"moment\";\n\nexport const getAgeFromBDate = bdate => {\n  let date = moment(bdate, \"DD.MM.YYYY\"); // move format to config\n  return moment().diff(date, \"years\", false);\n};","import React from 'react'\nimport { setActiveSheet } from '../../store/actions/sheetsActions';\nimport { backgroundImage } from '../../styles/inline';\nimport { setActivePanel } from '../../store/actions/panelActions';\nimport { useDispatch } from 'react-redux';\nimport \"./NewSheetSnippet.css\";\n\n\nconst NewSheetSnippet = props => {\n    const dispatch = useDispatch();\n    const { blueprint } = props;\n    return (\n        <div className=\"NewSheetSnippet\" onClick={ () => {\n                dispatch(setActiveSheet(blueprint));\n                dispatch(setActivePanel(\"details\"));\n            } }>\n            <div className=\"NewSheetSnippet-image\" style={ backgroundImage( blueprint.imageUrl) }></div>\n            <div className=\"NewSheetSnippet-content\">\n                <h4 className=\"NewSheetSnippet-title\">{ blueprint.type }</h4>\n                <p className=\"NewSheetSnippet-desc\">{ blueprint.desc }</p>\n            </div>\n        </div>\n    )\n}\n\nexport default NewSheetSnippet","import React from 'react'\nimport { Cell, List } from '@vkontakte/vkui';\nimport NewSheetSnippet from './NewSheetSnippet';\nimport \"./NewSheetList.css\";\n\nconst NewSheetList = props => {\n    const { blueprints } = props;\n    return (\n        <List className=\"NewSheetList\">  \n            { blueprints && blueprints.length !== 0 ? (\n                blueprints.map(blueprint => {\n                    return (\n                        <NewSheetSnippet \n                            key={ blueprint.type }\n                            blueprint={ blueprint }\n                        />\n                    )\n                })\n            ) : (\n                <Cell>\n                    <h3>No Sheet Blueprints =(</h3>\n                </Cell>\n            ) }\n        </List> \n    );\n}\n\nexport default NewSheetList","import React, { useEffect, useState } from 'react';\nimport {Panel, PanelHeader, platform, IOS, PanelHeaderButton } from '@vkontakte/vkui';\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\nimport PropTypes from 'prop-types';\nimport { useSelector, useDispatch } from 'react-redux';\nimport NewSheetList from '../../components/sheets/NewSheetList';\nimport { setActivePanel } from '../../store/actions/panelActions';\nimport { getSheetBlueprints, setActiveRubric } from '../../store/actions/sheetsActions';\nimport ErrorSnackbar from '../../components/interface/ErrorSnackbar';\n\nconst osname = platform();\n\nconst Catalog = props => {   \n    const dispatch = useDispatch();\n    const sheetBlueprints = useSelector(state => state.sheets.sheetBlueprints);\n    const sheetsError = useSelector(state => state.sheets.error);\n    const activeRubric = useSelector(state => state.sheets.activeRubric);\n    const [snackbar, setSnackbar] = useState(null);\n\n    const handleGoBack = () => {\n        dispatch(setActivePanel(\"rubrics\"));\n        dispatch(setActiveRubric(null));     \n    }\n\n    useEffect(() => {\n        dispatch(getSheetBlueprints(activeRubric));\n    }, [dispatch, activeRubric])\n\n\tuseEffect(() => {\n        const errorSnackbar = <ErrorSnackbar onClose={() => setSnackbar(null)} error={sheetsError} />\n\t\tif (sheetsError) {\n\t\t\tsetSnackbar(errorSnackbar)\n\t\t}\n\t}, [sheetsError])\n\n    return (\n        <Panel id={props.id}>\n            <PanelHeader\n                left={<PanelHeaderButton onClick={ handleGoBack }>\n                    {osname === IOS ? <Icon28ChevronBack/> : <Icon24Back/>}\n                </PanelHeaderButton>}\n            >\n                Каталог | { activeRubric ? activeRubric.title : \"Все листочки\" }\n            </PanelHeader>\n            <NewSheetList blueprints={ sheetBlueprints } />\n            { snackbar }\n        </Panel>\n    )\n}\n\nCatalog.propTypes = {\n\tid: PropTypes.string.isRequired,\n};\n\nexport default Catalog;","import React, { useState } from 'react';\nimport { List, Cell, Switch, FormLayout, FormLayoutGroup, Input  } from '@vkontakte/vkui';\n\nconst UserSettings = props => {\n    const { settings } = props;\n    const [ encrypt, setEncrypt ] = useState(settings ? settings.encrypt : false);\n    return (\n        <List>\n            <Cell \n                asideContent={ \n                    <Switch \n                        checked={ encrypt } \n                        onChange={ () => { setEncrypt(!encrypt) } } \n                    />\n                }\n            >\n                Шифровать тексты\n            </Cell>{\n                encrypt ? (\n                    <FormLayout>\n                        <FormLayoutGroup \n                            top=\"Укажите пароль для шифрования\"\n                            bottom=\"Хорошо запомните пароль. Он не хранится на сервере и используется для шифрования ваших текстов (не для доступа к приложению). Если вы потеряете пароль, восстановить зашифрованные тексты будет невозможно.\"\n                        >\n                            <Input type=\"text\" defaultValue=\"\" />\n                        </FormLayoutGroup>\n                    </FormLayout>\n                ) : (null)\n            }\n\n        </List>\n    )\n}\n\nexport default UserSettings;","import React from 'react';\nimport {Panel, PanelHeader, PanelHeaderButton, platform, Footer, IOS, PanelSpinner, Cell, Button, List } from '@vkontakte/vkui';\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\nimport PropTypes from 'prop-types';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { setActivePanel } from '../../store/actions/panelActions';\nimport UserSettings from '../../components/user/UserSettings';\n\nconst osname = platform();\n\nconst Settings = props => {\n    const dispatch = useDispatch();\n    const currentUser = useSelector(state => state.user.currentUser);\n    console.log(\"CURRENT USER\", currentUser);\n    return (\n        <Panel id={props.id}>\n            <PanelHeader\n                left={<PanelHeaderButton onClick={ () => dispatch(setActivePanel(\"home\")) }>\n                    {osname === IOS ? <Icon28ChevronBack/> : <Icon24Back/>}\n                </PanelHeaderButton>}\n            >\n                Profile Settings\n            </PanelHeader>{\n                currentUser ? (\n                    <UserSettings \n                        settings={ currentUser ? currentUser.settings : null } \n                    />\n                ) : (\n                    <PanelSpinner />\n                )\n            }\n            <List>\n                <Cell>\n                    <Button \n                        stretched \n                        size=\"xl\"\n                        onClick={ () => dispatch(setActivePanel(\"home\")) }\n                    >\n                        Назад\n                    </Button> \n                </Cell>\n            </List>\n            <Footer>Шифрование пока не работает</Footer>\n        </Panel>\n    )\n}\n\nSettings.propTypes = {\n\tid: PropTypes.string.isRequired,\n};\n\nexport default Settings;","import React from 'react';\nimport { Button, Separator } from '@vkontakte/vkui';\nimport reactHtmlParser from 'react-html-parser';\nimport \"./SheetGuideBlock.css\";\n\nconst SheetGuideBlock = props => {\n    const { title, text, onButtonClick } = props;\n    return (\n        <div className=\"SheetGuideBlock-body-wrap\">\n            <div className=\"SheetGuideBlock-body\">\n                <p><b>{ title }</b></p>\n                <Separator wide />\n                <div className=\"SheetGuideBlock-text-wrap\">{ text ? reactHtmlParser(text) : \"Пока нет для этого листочка\" }</div>\n                <Button\n                    size=\"m\" \n                    stretched \n                    mode=\"outline\"\n                    onClick={ onButtonClick } \n                >\n                    Свернуть\n                </Button>\n            </div>\n        </div>\n    );\n}\n\nexport default SheetGuideBlock;","import React, { useState } from 'react';\nimport { Switch, Cell } from '@vkontakte/vkui';\nimport SheetGuideBlock from './SheetGuideBlock';\nimport \"./SheetGuide.css\";\n\nconst SheetGuide = props => {\n    const { guide, example } = props.params;\n    const [ guideOpen, setGuideOpen ] = useState(false);\n    const [ exampleOpen, setExampleOpen ] = useState(false);\n    return (\n        <div className=\"SheetGuide\">\n            <Cell \n                className=\"SheetGuide-controls\" \n            >\n                <div className=\"SheetGuide-controls-inner-wrap\">\n                    <p className=\"SheetGuide-controls-text\">Инструкция</p>\n                    <Switch \n                        className=\"SheetGuide-switch\" \n                        checked={ guideOpen } \n                        onChange={ () => setGuideOpen(!guideOpen) } \n                    />\n                    <p className=\"SheetGuide-controls-text\">Пример</p>\n                    <Switch \n                        className=\"SheetGuide-switch\" \n                        checked={ exampleOpen } \n                        onChange={ () => setExampleOpen(!exampleOpen) } \n                    />\n                </div>\n            </Cell>\n            { guideOpen ? (\n                <SheetGuideBlock\n                    title={ \"Инструкция\" }\n                    text={ guide }\n                    onButtonClick={ () => setGuideOpen(!guideOpen) }\n                />\n            ) : null }\n            { exampleOpen ? (\n                <SheetGuideBlock\n                    title={ \"Пример\" }\n                    text={ example }\n                    onButtonClick={ () => setExampleOpen(!exampleOpen) }\n                />\n            ) : null }\n        </div>\n    )\n}\n\nexport default SheetGuide;","import React, { useEffect } from 'react';\nimport {Panel, PanelHeader, PanelHeaderButton, platform, Div, IOS, Button } from '@vkontakte/vkui';\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\nimport PropTypes from 'prop-types';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setActivePanel } from '../../store/actions/panelActions';\nimport { updateActiveSheetData, postActiveSheet } from '../../store/actions/sheetsActions';\nimport { buildSheetStructure, getElementMapping } from '../../utils/sheetsBuilder';\nimport SheetGuide from '../../components/sheets/SheetGuide';\nimport SheetHeader from '../../components/sheets/SheetHeader';\nimport appConfig from '../../config/appConfig';\nimport \"./Editor.css\";\n\n\nconst osname = platform();\n\nconst Editor = props => {\n    const dispatch = useDispatch();\n    const activeSheet = useSelector(state => state.sheets.activeSheet);\n    const sheetBody = buildSheetStructure(\n        activeSheet.blueprint.structure,\n        activeSheet.data,\n        (id, data, field) => dispatch(updateActiveSheetData(id, data, field)),\n        getElementMapping(),\n    )\n\n    useEffect(() => {\n        const interval = setInterval(\n            () => {\n                dispatch(postActiveSheet())\n            },\n            appConfig.EDITOR_SAVE_INTERVAL);\n        return () => {\n            clearInterval(interval);\n            dispatch(postActiveSheet())\n        };\n    }, [dispatch]);\n\n    return (\n        <Panel id={props.id}>\n            <PanelHeader\n                left={<PanelHeaderButton onClick={ () => dispatch(setActivePanel(\"home\")) } >\n                    {osname === IOS ? <Icon28ChevronBack/> : <Icon24Back/>}\n                </PanelHeaderButton>}\n            >\n                Sheets Editor\n            </PanelHeader>\n            <div className=\"Editor-header-wrap\">\n                <SheetHeader params={ { \"imageURL\": activeSheet.blueprint.imageUrl } } />\n                <SheetGuide params={ { \"guide\": activeSheet.blueprint.guide, \"example\": activeSheet.blueprint.example} } />\n            </div>\n            <Div className=\"Editor-sheet-wrap\">\n                {sheetBody}\n            </Div>\n            <Div>\n                <Button \n                    stretched \n                    size=\"xl\"\n                    onClick={ () => dispatch(setActivePanel(\"home\")) }\n                >\n                    Сохранить и вернуться\n                </Button> \n            </Div>\n        </Panel>\n    )\n}\n\nEditor.propTypes = {\n\tid: PropTypes.string.isRequired,\n};\n\nexport default Editor;","import React from 'react';\nimport { List, Cell, Div, Button, InfoRow } from '@vkontakte/vkui';\nimport { backgroundImage } from '../../styles/inline';\nimport { setActiveSheet, setActiveRubric } from '../../store/actions/sheetsActions';\nimport { setActivePanel } from '../../store/actions/panelActions';\nimport { useDispatch } from 'react-redux';\nimport reactHtmlParser from 'react-html-parser';\nimport \"./SheetDetails.css\";\n\n\nconst SheetDetails = props => {\n    const dispatch = useDispatch();\n    const { blueprint } = props;\n    return (\n        blueprint ? (\n            <React.Fragment>\n                <Div className=\"SheetDetails-image-wrap\" style={backgroundImage(blueprint.imageUrl)}></Div>\n                <List>\n                    <Cell>\n                        <InfoRow title=\"Название\">\n                            { blueprint.type }\n                        </InfoRow>\n                    </Cell>\n                    <Cell multiline>\n                        <InfoRow title=\"Описание\" size='l'>\n                            { blueprint.desc }\n                        </InfoRow>\n                    </Cell>\n                    <Cell multiline>\n                        <InfoRow title=\"Инструкция\" size='l'>\n                            { reactHtmlParser(blueprint.guide) }\n                        </InfoRow>\n                    </Cell>\n                    <Cell>\n                        <Div>\n                            <Button \n                                stretched \n                                size=\"xl\"\n                                onClick={ () => {\n                                    dispatch(setActiveSheet(null));\n                                    dispatch(setActivePanel(\"catalog\"));\n                                } }\n                            >\n                                Назад\n                            </Button>\n                        </Div>\n                        <Div>\n                            <Button \n                                stretched \n                                size=\"xl\"\n                                mode=\"secondary\"\n                                onClick={ () => {\n                                    dispatch(setActiveRubric(null)); // clear rubric if sheet is selected\n                                    dispatch(setActivePanel(\"editor\"));\n                                } }\n                            >\n                                Выбрать!\n                            </Button>\n                        </Div>\n                    </Cell>\n                </List>\n            </React.Fragment>\n        ) : (\n            null\n        )\n    )\n}\n\nexport default SheetDetails;","import React from 'react';\nimport {Panel, PanelHeader, PanelHeaderButton, platform, IOS } from '@vkontakte/vkui';\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\nimport PropTypes from 'prop-types';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setActivePanel } from '../../store/actions/panelActions';\nimport SheetDetails from '../../components/sheets/SheetDetails';\nimport { setActiveSheet } from '../../store/actions/sheetsActions';\n\nconst osname = platform();\n\nconst Details = props => {   \n    const dispatch = useDispatch();\n    const activeSheet = useSelector(state => state.sheets.activeSheet);\n    \n    return (\n        <Panel id={props.id}>\n            <PanelHeader\n                left={\n                    <PanelHeaderButton \n                        onClick={ \n                            () => {\n                                dispatch(setActiveSheet(null));\n                                dispatch(setActivePanel(\"catalog\"));\n                            }\n                        }\n                    >\n                        {osname === IOS ? <Icon28ChevronBack/> : <Icon24Back/>}\n                    </PanelHeaderButton>\n                }\n            >\n                Sheet Details\n            </PanelHeader>\n            <SheetDetails blueprint={ activeSheet ? activeSheet.blueprint : null } />\n        </Panel>\n    )\n}\n\nDetails.propTypes = {\n\tid: PropTypes.string.isRequired,\n};\n\nexport default Details;","import React from 'react';\nimport {Panel, PanelHeader, PanelHeaderButton, platform, Footer, IOS, Cell, List, Button } from '@vkontakte/vkui';\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\nimport PropTypes from 'prop-types';\nimport { useDispatch } from 'react-redux';\nimport { setActivePanel } from '../../store/actions/panelActions';\n\nconst osname = platform();\n\nconst About = props => {\n    const dispatch = useDispatch();\n    return (\n        <Panel id={props.id}>\n            <PanelHeader\n                left={<PanelHeaderButton onClick={ () => dispatch(setActivePanel(\"home\")) }>\n                    {osname === IOS ? <Icon28ChevronBack/> : <Icon24Back/>}\n                </PanelHeaderButton>}\n            >\n                О приложении\n            </PanelHeader>\n            <List>\n                <Cell multiline>\n                    <h1>Умные листочки</h1>\n                    <p>Это приложение - сборник письменных практик для VK.</p>\n                    <p>\n                        Каждая практика - отдельный \"листочек\". \n                        Листочки сохраняются при выходе из редактора \n                        (с помощью стрелочки \"назад\" в шапке или кнопки \"сохранить и вернуться\" внизу страницы), \n                        а также автоматически каждые 50 секунд. \n                        Их можно создавать в любом количества, всегда можно вернуться к предыдущим.\n                    </p>\n                    <p>\n                        Насчет безопасности: индентификация происходит автоматически по номер пользователя VK, \n                        но сами номера в базе не хранятся, \n                        сохраняются безопасные хэши из них (т.е. восстановить исходный айдишник по хэшу нельзя). \n                        Таким образом, невозможно определить, кто что написал. \n                        В ближайшее время будет поддержано также шифрование текстов на стороне пользователя.\n                        Код приложения можно посмотреть в репозитории автора: \n                        <span>&nbsp;\n                            <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/DanielTitkov/smart-sheets-backend\">бэкенд</a>\n                        </span>\n                        <span>&nbsp;\n                            <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/DanielTitkov/smart-sheets-vk-frontend\">фронтенд</a>\n                        </span>.\n                        <br/>Приложение развенуто на Google Cloud Platform. \n                    </p>\n                    <p>\n                        Приложение пока в стадии тестирования. \n                        Если что-нибудь не работает, напишите автору.\n                        Если у вас есть какие-нибудь идеи насчет развития приложения - тоже пишите, пожалуйста.\n                    </p>\n                </Cell>\n                <Cell>\n                    <Button \n                        stretched \n                        size=\"xl\"\n                        onClick={ () => dispatch(setActivePanel(\"home\")) }\n                    >\n                        Назад\n                    </Button> \n                </Cell>\n            </List>\n            <Footer>Write for happiness</Footer>\n        </Panel>\n    )\n}\n\nAbout.propTypes = {\n\tid: PropTypes.string.isRequired,\n};\n\nexport default About;","import React from 'react'\nimport { useDispatch } from 'react-redux';\nimport { avatarStyle } from '../../../styles/inline';\nimport Icon28ChevronRightOutline from '@vkontakte/icons/dist/28/chevron_right_outline';\nimport { setActivePanel } from '../../../store/actions/panelActions';\nimport { Avatar, RichCell } from '@vkontakte/vkui';\nimport \"./RubricSnippet.css\";\nimport { setActiveRubric } from '../../../store/actions/sheetsActions';\n\n\nconst RubricSnippet = props => {\n    const dispatch = useDispatch();\n    const { rubric } = props;\n    return (\n        <RichCell \n            disabled\n            className=\"RubricSnippet\" \n            multiline\n            before={<Avatar style={ avatarStyle } src={ rubric.imageUrl } />}\n            caption={ rubric.desc }\n            after={\n                <Icon28ChevronRightOutline \n                    onClick={ () => {\n                        dispatch(setActiveRubric(rubric));\n                        if (rubric.hasChildren) {\n                            dispatch(setActivePanel(\"rubrics\"));\n                        } else {\n                            dispatch(setActivePanel(\"catalog\"));\n                        }\n                    } }\n                />\n            }\n        >\n            { rubric.title }\n        </RichCell>\n    )\n}\n\nexport default RubricSnippet;","import React from 'react'\nimport { Cell, Group } from '@vkontakte/vkui';\nimport RubricSnippet from './RubricSnippet';\nimport \"./RubricsList.css\";\n\nconst RubricsList = props => {\n    const { rubrics } = props;\n    return (\n        <Group className=\"RubricsList\">\n            { rubrics && rubrics.length !== 0 ? (rubrics.map(rubric => {\n                    return (\n                        <RubricSnippet \n                            key={ rubric.id }\n                            rubric={ rubric }\n                        />\n                    )\n                })\n            ) : (\n                <Cell>\n                    <h3>No rubrics =(</h3>\n                </Cell>\n            ) }\n        </Group>\n    );\n}\n\nexport default RubricsList;","import React, { useEffect, useState } from 'react';\nimport {Panel, PanelHeader, PanelHeaderButton, platform, IOS, Spinner } from '@vkontakte/vkui';\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\nimport PropTypes from 'prop-types';\nimport { useSelector, useDispatch } from 'react-redux';\nimport ErrorSnackbar from '../../../components/interface/ErrorSnackbar';\nimport { setActivePanel } from '../../../store/actions/panelActions';\nimport { getSheetRubrics, setActiveRubric } from '../../../store/actions/sheetsActions';\nimport RubricsList from '../../../components/sheets/rubrics/RubricsList';\n\nconst osname = platform();\n\nconst Rubrics = props => {   \n    const dispatch = useDispatch();\n    const rubrics = useSelector(state => state.sheets.rubrics);\n    const loading = useSelector(state => state.sheets.loading);\n    const sheetsError = useSelector(state => state.sheets.error);\n    const activeRubric = useSelector(state => state.sheets.activeRubric);\n    const activePanel = useSelector(state => state.panel.activePanel);\n    const [snackbar, setSnackbar] = useState(null);\n\n    const handleGoBack = () => {\n        if (activeRubric && (activeRubric.hasChildren || activeRubric.parent)) {\n            if (activeRubric.parent) {\n                dispatch(setActiveRubric(activeRubric.parent));\n            } else {\n                dispatch(setActiveRubric(null));\n            }\n            dispatch(setActivePanel(\"rubrics\"));\n        } else {\n            dispatch(setActivePanel(\"home\"));\n        }\n    }\n\n    useEffect(() => {\n        if (activeRubric && (activeRubric.hasChildren || activeRubric.parent)) {\n            dispatch(getSheetRubrics(activeRubric));\n        } else {\n            dispatch(getSheetRubrics());\n        }\n    }, [dispatch, activeRubric, activePanel])\n\n\tuseEffect(() => {\n        const errorSnackbar = <ErrorSnackbar onClose={() => setSnackbar(null)} error={sheetsError} />\n\t\tif (sheetsError) {\n\t\t\tsetSnackbar(errorSnackbar)\n\t\t}\n\t}, [sheetsError])\n\n    return (\n        <Panel id={props.id}>\n            <PanelHeader\n                left={<PanelHeaderButton onClick={ handleGoBack }>\n                    {osname === IOS ? <Icon28ChevronBack/> : <Icon24Back/>}\n                </PanelHeaderButton>}\n            >\n                Sheets Rubrics | { activeRubric ? activeRubric.title : \"все\" }\n            </PanelHeader>\n            { loading ? (\n                <Spinner size=\"large\" className=\"SheetList-spinner\" />\n            ) : (\n                <RubricsList rubrics={ rubrics } />\n            ) }\n            { snackbar }\n        </Panel>\n    )\n}\n\nRubrics.propTypes = {\n\tid: PropTypes.string.isRequired,\n};\n\nexport default Rubrics;","import React, { useEffect } from 'react';\nimport { View, Spinner, Footer } from '@vkontakte/vkui';\nimport Home from './panels/Home';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { getValidationQuery } from './store/actions/validationActions';\nimport { getCurrentUser } from './store/actions/userActions';\nimport Catalog from './panels/sheets/Catalog';\nimport ProfileSettings from './panels/profile/Settings';\nimport Editor from './panels/sheets/Editor';\nimport Details from './panels/sheets/Details';\nimport About from './panels/about/About';\nimport Rubrics from './panels/sheets/rubrics/Rubrics';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport './styles/bright_light.css';\n\nconst App = props => {\n\tconst dispatch = useDispatch();\n\tconst activePanel = useSelector(state => state.panel.activePanel);\n\tconst modal = useSelector(state => state.modal.modal);\n\tconst vkquery = useSelector(state => state.validation.vkquery);\n\tconst popout = useSelector(state => state.popout.popout);\n\n\tuseEffect(() => {\n\t\tdispatch(getValidationQuery());\n\t\tdispatch(getCurrentUser());\n\t}, [dispatch])\n\n\tif (vkquery) {\n\t\treturn (\n\t\t\t<View popout={popout} modal={modal} activePanel={activePanel}>\n\t\t\t\t<About id=\"about\" />\n\t\t\t\t<ProfileSettings id=\"profilesettings\" />\n\t\t\t\t<Home id=\"home\" />\n\t\t\t\t<Rubrics id=\"rubrics\" />\n\t\t\t\t<Catalog id=\"catalog\" />\n\t\t\t\t<Details id=\"details\" />\n\t\t\t\t<Editor id=\"editor\" />\n\t\t\t</View>\n\t\t)\n\t} else {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Spinner size=\"large\" style={{ marginTop: 20 }} />\n\t\t\t\t<Footer>Loading... If this doesn't go away you may be using the app outside of VK</Footer>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default App;","export const getValidationQuery = (response) => {\n    return (dispatch, getState) => {\n        const parseQueryString = (string) => {\n            return string.slice(1).split('&')\n                .map((queryParam) => {\n                    let kvp = queryParam.split('=');\n                    return {key: kvp[0], value: kvp[1]}\n                })\n                .reduce((query, kvp) => {\n                    query[kvp.key] = kvp.value;\n                    return query\n                }, {})\n        };\n        const queryParams = parseQueryString(window.location.search);\n        const hashParams = parseQueryString(window.location.hash);\n        // fix comma encoding for validation\n        queryParams.vk_access_token_settings = decodeURIComponent(queryParams.vk_access_token_settings);\n        dispatch({ type: \"GET_VK_QUERY\", query: queryParams, hash: hashParams });\n    }\n};","const initState = {\n    activePanel: 'home'\n}\n\nconst panelReducer = (state=initState, action) => {\n    switch (action.type) {\n        case \"SET_ACTIVE_PANEL\":\n            return {activePanel: action.panel};\n        default:\n            return state;\n    }\n}\n\nexport default panelReducer;","const initState = {\n    vkquery: null\n}\n\nconst validationReducer = (state=initState, action) => {\n    switch (action.type) {\n        case \"GET_VK_QUERY\":\n            return {\n                ...state,\n                vkquery: {\n                    query: action.query,\n                    hash: action.hash\n                }\n            }\n        default:\n            return state;\n    }\n}\n\nexport default validationReducer;","const initState = {\n    currentUser: null,\n    error: null\n}\n\nconst userReducer = (state=initState, action) => {\n    switch (action.type) {\n        case \"GET_VK_USER_SUCCESS\":\n            return {\n                ...state,\n                currentUser: {\n                    ...state.currentUser,\n                    profile: action.user,\n                },\n            }\n        case \"GET_VK_USER_ERROR\":\n            return {\n                ...state,\n                error: action.error,\n            }\n        case \"SEND_USER_DATA_SUCCESS\":\n            return {\n                ...state,\n            }\n        case \"SEND_USER_DATA_ERROR\":\n            return {\n                ...state,\n                error: action.error,\n            }\n        case \"GET_USER_SETTINGS_SUCCESS\":\n            return {\n                ...state,\n                currentUser: {\n                    ...state.currentUser,\n                    settings: action.settings,\n                }\n            };      \n        case \"GET_USER_SETTINGS_ERROR\":\n            return {\n                ...state,\n                error: action.error,\n            }\n        default:\n            return state;\n    }\n}\n\nexport default userReducer;","const initState = {\n    modal: null\n}\n\nconst modalReducer = (state=initState, action) => {\n    switch (action.type) {\n        case \"OPEN_MODAL\":\n            return {modal: action.modal};\n        case \"CLOSE_MODAL\":\n            return {modal: null}\n        default:\n            return state;\n    }\n}\n\nexport default modalReducer;","import { dataArrayToObject } from \"../../utils/arrayUtils\";\n\nconst initState = {\n    activeSheet: null,\n    recentSheets: null,\n    sheetBlueprints: null,\n    rubrics: null,\n    parentRubric: null,\n    activeRubric: null,\n    error: null,\n    loading: false,\n}\n\nconst sheetsReducer = (state=initState, action) => {\n    switch (action.type) {\n        case \"SET_ACTIVE_SHEET\":\n            return {\n                ...state,\n                activeSheet: action.sheet && action.sheet.blueprint ? ({\n                    ...action.sheet\n                }) : null\n            };\n        case \"SET_ACTIVE_RUBRIC\":\n            return {\n                ...state,\n                activeRubric: action.rubric ? ({\n                    ...action.rubric\n                }) : null\n            }\n        case \"UPDATE_ACTIVE_SHEET_DATA\":\n            return {\n                ...state,\n                activeSheet: {\n                    ...state.activeSheet,\n                    data: {\n                        ...state.activeSheet.data,\n                        [action.id] : action.data,\n                    },\n                }\n            };\n        case \"GET_RECENT_SHEETS_SUCCESS\":\n            return {\n                ...state,\n                loading: false,\n                error: null,\n                recentSheets: action.sheets.map(sheet => {\n                    return {\n                        ...sheet,\n                        data: dataArrayToObject(sheet.data)\n                    }\n                })\n            };\n        case \"GET_RECENT_SHEET_ERROR\":\n            return {\n                ...state,\n                loading: false,\n                error: action.error\n            };\n        case \"GET_SHEET_BLUEPRINTS_SUCCESS\":\n            return {\n                ...state,\n                error: null,\n                loading: false,\n                sheetBlueprints: action.blueprints\n            };\n        case \"POST_ACTIVE_SHEET_SUCCESS\":\n            return {\n                ...state,\n                error: null,\n                activeSheet: {\n                    ...action.sheet,\n                    data: dataArrayToObject(action.sheet.data) // maybe move this into action?\n                }\n            };\n        case \"POST_ACTIVE_SHEET_ERROR\":\n            return {\n                ...state,\n                error: action.error\n            };         \n        case \"GET_SHEET_BLUEPRINTS_ERROR\":\n            return {\n                ...state,\n                loading: false,\n                error: action.error\n            };\n        case \"DELETE_SHEET_SUCCESS\":\n            return {\n                ...state,\n                error: null,\n                activeSheet: state.activeSheet && (state.activeSheet.id === action.id) ? null : state.activeSheet\n            };\n        case \"DELETE_SHEET_ERROR\":\n            return {\n                ...state,\n                error: action.error\n            };\n        case \"GET_SHEET_RUBRICS_SUCCESS\":\n            return {\n                ...state,\n                error: null,\n                loading: false,\n                rubrics: action.rubrics\n            };\n        case \"GET_SHEET_RUBRICS_ERROR\":\n            return {\n                ...state,\n                loading: false,\n                error: action.error\n            };\n        case \"SET_LOADING\":\n            return {\n                ...state,\n                loading: true,\n            }\n        default:\n            return state;\n    }\n}\n\nexport default sheetsReducer;","const initState = {\n    popout: null\n}\n\nconst popoutReducer = (state=initState, action) => {\n    switch (action.type) {\n        case \"OPEN_POPOUT\":\n            return {popout: action.popout};\n        case \"CLOSE_POPOUT\":\n            return {popout: null}\n        default:\n            return state;\n    }\n}\n\nexport default popoutReducer;","import { combineReducers } from 'redux';\nimport panelReducer from './panelReducer';\nimport validationReducer from './validationReducer';\nimport userReducer from './userReducer';\nimport modalReducer from './modalReducer';\nimport sheetsReducer from './sheetsReducer';\nimport popoutReducer from './popoutReducer';\n\nconst rootReducer = combineReducers({\n    panel: panelReducer,\n    validation: validationReducer,\n    user: userReducer,\n    modal: modalReducer,\n    sheets: sheetsReducer,\n    popout: popoutReducer,\n});\n\nexport default rootReducer;","import React from 'react'\nimport { Provider } from 'react-redux'\n\nconst ProviderWrapper = ({ children, store }) => (\n    <Provider store={store}>\n        { children }\n    </Provider>\n)\n\nexport default ProviderWrapper","import 'core-js/features/map';\nimport 'core-js/features/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n// import vkconnect from '@vkontakte/vk-bridge';\nimport vkconnect from '@vkontakte/vk-connect';\nimport App from './App';\n// import registerServiceWorker from './sw';\nimport { createStore, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport rootReducer from './store/reducers/rootReducer';\nimport ProviderWrapper from './Provider';\n\n// Init VK  Mini App\nvkconnect.send('VKWebAppInit', {});\n\nconst store = createStore(\n    rootReducer,\n    applyMiddleware(thunk)\n);\n\nconst SmartSheetsApp = () => (\n    <ProviderWrapper store={ store }>\n        <App />\n    </ProviderWrapper>\n);\n\nReactDOM.render(\n    <SmartSheetsApp />, document.getElementById('root')\n);"],"sourceRoot":""}